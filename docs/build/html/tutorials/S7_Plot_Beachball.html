

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Plot Beachball with Station Projected &mdash; MCMTpy-test 0.1.0a1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Moment Tensor Decompose" href="S8_Decompose_MT.html" />
    <link rel="prev" title="Conversion of Source Parameters" href="S6_Conver_FM.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MCMTpy-test
          

          
            
            <img src="../_static/logo-small-cut.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.0a1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installing:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial_detailed.html">Tutorial_Detailed</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="S1_Build_GFs.html">Calculate Green Function Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="S2_Syn_Waveform.html">Synthesize the Test Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="S3_Process_Data.html">Prepare Data for MCMTpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="S4_Inv_DC.html">Inversion of  Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="S5_Plot_Result.html">Result Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="S6_Conver_FM.html">Conversion of Source Parameters</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Plot Beachball with Station Projected</a></li>
<li class="toctree-l2"><a class="reference internal" href="S8_Decompose_MT.html">Moment Tensor Decompose</a></li>
<li class="toctree-l2"><a class="reference internal" href="S9_Plot_Hudson.html">Huston Plot</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">References:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MCMTpy-test</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../tutorial_detailed.html">Tutorial_Detailed</a> &raquo;</li>
        
      <li>Plot Beachball with Station Projected</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorials/S7_Plot_Beachball.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="plot-beachball-with-station-projected">
<h1>Plot Beachball with Station Projected<a class="headerlink" href="#plot-beachball-with-station-projected" title="Permalink to this headline">Â¶</a></h1>
<ul class="simple">
<li><p>The <strong>example_path</strong> need to de changed to your path, and run this notebook.</p></li>
</ul>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">obspy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">obspy</span> <span class="kn">import</span> <span class="n">Stream</span>
<span class="kn">from</span> <span class="nn">obspy.taup</span> <span class="kn">import</span> <span class="n">TauPyModel</span>
<span class="kn">from</span> <span class="nn">obspy.imaging.mopad_wrapper</span> <span class="kn">import</span> <span class="n">beach</span>
<span class="kn">from</span> <span class="nn">MCMTpy</span> <span class="kn">import</span> <span class="n">MomentTensor</span> <span class="k">as</span> <span class="n">MTpy</span>

<span class="c1"># Helper function</span>
<span class="c1">#----------------------------------------------------#</span>
<span class="c1">#%% 1.read raw data</span>
<span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="n">allfiles_path</span><span class="p">):</span>

    <span class="n">allfiles</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">allfiles_path</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">data_raw</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">allfiles</span><span class="p">),</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">allfiles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">data_raw</span> <span class="o">+=</span> <span class="n">tr</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">allfiles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;: no such file or obspy read error&#39;</span><span class="p">);</span><span class="k">continue</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data_raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">data</span>

<span class="c1">#----------------------------------------------------#</span>
<span class="c1">#%% 2.taup ray trace</span>
<span class="k">def</span> <span class="nf">get_taup_tp_ts</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="n">distance</span><span class="p">,</span><span class="n">degree</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">degree</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="n">distance</span><span class="o">/</span><span class="mf">111.19</span>

    <span class="n">time_p</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_travel_times</span><span class="p">(</span><span class="n">source_depth_in_km</span><span class="o">=</span><span class="n">depth</span><span class="p">,</span>
                                    <span class="n">distance_in_degree</span><span class="o">=</span><span class="n">distance</span><span class="p">,</span>
                                    <span class="n">phase_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">])</span>

    <span class="n">time_s</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_travel_times</span><span class="p">(</span><span class="n">source_depth_in_km</span><span class="o">=</span><span class="n">depth</span><span class="p">,</span>
                                    <span class="n">distance_in_degree</span><span class="o">=</span><span class="n">distance</span><span class="p">,</span>
                                    <span class="n">phase_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">])</span>

    <span class="n">ray_p</span> <span class="o">=</span> <span class="n">time_p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ray_param</span>
    <span class="n">tp</span> <span class="o">=</span> <span class="n">time_p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
    <span class="n">angle_p</span> <span class="o">=</span> <span class="n">time_p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">incident_angle</span>

    <span class="n">ray_s</span> <span class="o">=</span> <span class="n">time_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ray_param</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">time_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
    <span class="n">angle_s</span> <span class="o">=</span> <span class="n">time_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">incident_angle</span>

    <span class="k">return</span> <span class="n">ray_p</span><span class="p">,</span><span class="n">tp</span><span class="p">,</span><span class="n">angle_p</span><span class="p">,</span><span class="n">ray_s</span><span class="p">,</span><span class="n">ts</span><span class="p">,</span><span class="n">angle_s</span>


<span class="c1">#%%------------------------------------------------------------#</span>
<span class="c1"># 0. set path</span>
<span class="n">example_path</span> <span class="o">=</span> <span class="s1">&#39;/Users/yf/3.Project/8.MCMTpy/MCMTpy-master/data/example_yunnan&#39;</span>


<span class="c1">#------------------------------------------------------------#</span>
<span class="c1"># we expect no parameters need to be changed below</span>
<span class="c1">#------------------------------------------------------------#</span>
<span class="n">FM_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">example_path</span><span class="p">,</span><span class="s2">&quot;YN.202105212148_Inv/dc_inv/Output_YN.202105212148_dc/rank_0_output/chain_0_FM_accept_all&quot;</span><span class="p">)</span>
<span class="n">allfiles_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">example_path</span><span class="p">,</span><span class="s1">&#39;YN.202105212148_Inv/YN.202105212148_raw/*.SAC&#39;</span><span class="p">)</span> 

<span class="c1">## 1. read FM</span>
<span class="n">N</span><span class="o">=</span><span class="mi">3</span> <span class="c1"># Three parameters are required to describe the focal mechanism</span>
<span class="n">FM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">FM_path</span><span class="p">)</span>
<span class="n">FM_raw</span> <span class="o">=</span> <span class="n">FM_all</span><span class="p">[</span><span class="mi">0</span><span class="p">:,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Define the number of solutions you want to plot</span>
<span class="n">strike_np</span> <span class="o">=</span> <span class="n">FM_raw</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">dip_np</span> <span class="o">=</span> <span class="n">FM_raw</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">rake_np</span> <span class="o">=</span> <span class="n">FM_raw</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">FM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">strike_np</span><span class="p">,</span> <span class="n">dip_np</span><span class="p">,</span>  <span class="n">rake_np</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="n">FM_mean</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">FM_mean</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">FM</span><span class="p">[</span><span class="mi">0</span><span class="p">:,</span><span class="n">i</span><span class="p">])</span>

<span class="c1">## 2.read raw data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">read_data</span><span class="p">(</span><span class="n">allfiles_path</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">freqmin</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">freqmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">corners</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">zerophase</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">## 3.ray trace with taup</span>
<span class="n">model_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">example_path</span><span class="p">,</span><span class="s2">&quot;v_model/v_model.npz&quot;</span><span class="p">)</span> 
<span class="n">model</span> <span class="o">=</span> <span class="n">TauPyModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_path</span><span class="p">)</span>    <span class="c1"># &quot;iasp91&quot;  &quot;prem&quot;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">depth</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sac</span><span class="p">[</span><span class="s1">&#39;evdp&#39;</span><span class="p">]</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sac</span><span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">]</span>
    <span class="n">ray_p</span><span class="p">,</span><span class="n">tp</span><span class="p">,</span><span class="n">angle_p</span><span class="p">,</span><span class="n">ray_s</span><span class="p">,</span><span class="n">ts</span><span class="p">,</span><span class="n">angle_s</span> <span class="o">=</span> <span class="n">get_taup_tp_ts</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="n">distance</span><span class="p">,</span><span class="n">degree</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>                                            
    <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sac</span><span class="p">[</span><span class="s2">&quot;user1&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">angle_p</span>
    <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sac</span><span class="p">[</span><span class="s2">&quot;user2&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">angle_s</span>

<span class="c1">## 4.1 plot FM_mean</span>
<span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">Length_Ball</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">beach1</span> <span class="o">=</span> <span class="n">beach</span><span class="p">(</span><span class="n">FM_mean</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>  <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">Length_Ball</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>\
               <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">mopad_basis</span><span class="o">=</span><span class="s1">&#39;NED&#39;</span><span class="p">,</span><span class="n">nofill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">beach1</span><span class="p">)</span> 
<span class="n">ax0</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>

<span class="c1">## 4.2 plot FM_all</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">FM</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">beach1</span> <span class="o">=</span> <span class="n">beach</span><span class="p">(</span><span class="n">FM</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>  <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">Length_Ball</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>\
                <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">mopad_basis</span><span class="o">=</span><span class="s1">&#39;NED&#39;</span><span class="p">,</span><span class="n">nofill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">beach1</span><span class="p">)</span> 
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>

<span class="c1">## 4.3 plot backgroud line</span>
<span class="n">beach1</span> <span class="o">=</span> <span class="n">beach</span><span class="p">(</span><span class="n">FM_mean</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>  <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">Length_Ball</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>\
                <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">mopad_basis</span><span class="o">=</span><span class="s1">&#39;NED&#39;</span><span class="p">,</span><span class="n">nofill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">beach1</span><span class="p">)</span> 
<span class="n">ax0</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>

<span class="c1">## 5.plot station and waveform</span>
<span class="n">menthod</span><span class="o">=</span><span class="s1">&#39;schmidt&#39;</span>   <span class="c1"># &#39;schmidt&#39; &#39;wulff&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">AZM</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sac</span><span class="p">[</span><span class="s1">&#39;az&#39;</span><span class="p">]</span> 
    <span class="n">TKO</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sac</span><span class="p">[</span><span class="s1">&#39;user1&#39;</span><span class="p">]</span>
    <span class="n">net_sta_name</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">network</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span>    
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">MTpy</span><span class="o">.</span><span class="n">project_beachball</span><span class="p">(</span><span class="n">AZM</span><span class="p">,</span> <span class="n">TKO</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="n">Length_Ball</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">menthod</span><span class="o">=</span><span class="n">menthod</span><span class="p">)</span>    
    <span class="n">tt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">))</span> 
    <span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s2">&quot;rv&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
    <span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="mi">2000000</span> <span class="o">+</span> <span class="n">Y</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span><span class="n">net_sta_name</span><span class="p">,</span><span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>\
          <span class="n">fontsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">bbox</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">),</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

<span class="c1">## 6. plot P/T/N axis</span>
<span class="n">MT</span> <span class="o">=</span> <span class="n">MTpy</span><span class="o">.</span><span class="n">str_dip_rake2MT</span><span class="p">(</span><span class="n">strike</span><span class="o">=</span><span class="n">FM_mean</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">dip</span><span class="o">=</span><span class="n">FM_mean</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">rake</span><span class="o">=</span><span class="n">FM_mean</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">T_axis</span><span class="p">,</span> <span class="n">P_axis</span><span class="p">,</span> <span class="n">N_axis</span> <span class="o">=</span> <span class="n">MTpy</span><span class="o">.</span><span class="n">MT2TPN</span><span class="p">(</span><span class="n">MT</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">MTpy</span><span class="o">.</span><span class="n">vector2str_dip</span><span class="p">(</span><span class="n">T_axis</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">MTpy</span><span class="o">.</span><span class="n">vector2str_dip</span><span class="p">(</span><span class="n">P_axis</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">MTpy</span><span class="o">.</span><span class="n">vector2str_dip</span><span class="p">(</span><span class="n">N_axis</span><span class="p">)</span>

<span class="n">Tx</span><span class="p">,</span> <span class="n">Ty</span> <span class="o">=</span> <span class="n">MTpy</span><span class="o">.</span><span class="n">project_beachball</span><span class="p">(</span><span class="n">AZM</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">strike</span><span class="p">,</span> <span class="n">TKO</span><span class="o">=</span><span class="p">(</span><span class="mi">90</span><span class="o">-</span><span class="n">T</span><span class="o">.</span><span class="n">dip</span><span class="p">),</span> <span class="n">R</span><span class="o">=</span><span class="n">Length_Ball</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">menthod</span><span class="o">=</span><span class="n">menthod</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Tx</span><span class="p">,</span><span class="n">Ty</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>\
          <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

<span class="n">Px</span><span class="p">,</span> <span class="n">Py</span> <span class="o">=</span> <span class="n">MTpy</span><span class="o">.</span><span class="n">project_beachball</span><span class="p">(</span><span class="n">AZM</span><span class="o">=</span><span class="n">P</span><span class="o">.</span><span class="n">strike</span><span class="p">,</span> <span class="n">TKO</span><span class="o">=</span><span class="p">(</span><span class="mi">90</span><span class="o">-</span><span class="n">P</span><span class="o">.</span><span class="n">dip</span><span class="p">),</span> <span class="n">R</span><span class="o">=</span><span class="n">Length_Ball</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">menthod</span><span class="o">=</span><span class="n">menthod</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Px</span><span class="p">,</span><span class="n">Py</span><span class="p">,</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>\
          <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

<span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span> <span class="o">=</span> <span class="n">MTpy</span><span class="o">.</span><span class="n">project_beachball</span><span class="p">(</span><span class="n">AZM</span><span class="o">=</span><span class="n">N</span><span class="o">.</span><span class="n">strike</span><span class="p">,</span> <span class="n">TKO</span><span class="o">=</span><span class="p">(</span><span class="mi">90</span><span class="o">-</span><span class="n">N</span><span class="o">.</span><span class="n">dip</span><span class="p">),</span> <span class="n">R</span><span class="o">=</span><span class="n">Length_Ball</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">menthod</span><span class="o">=</span><span class="n">menthod</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>\
          <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 


<span class="c1">## 7. save figure</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span> 
<span class="n">figurename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;./S2_figure/beachball.pdf&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figurename</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;pdf&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<a class="reference internal image-reference" href="../_images/beachball1.png"><img alt="../_images/beachball1.png" class="align-center" src="../_images/beachball1.png" style="width: 100%;" /></a>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="S8_Decompose_MT.html" class="btn btn-neutral float-right" title="Moment Tensor Decompose" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="S6_Conver_FM.html" class="btn btn-neutral float-left" title="Conversion of Source Parameters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Fu Yin.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>