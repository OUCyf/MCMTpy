%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[a4paper,10pt,english,openany]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}

\PassOptionsToPackage{warn}{textcomp}


\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Installing:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}


\usepackage{xeCJK}
\usepackage{indentfirst}
\setlength{\parindent}{2em}
\setCJKmainfont[BoldFont=SimHei, ItalicFont=STKaiti]{SimSun}
\setCJKmonofont[Scale=0.9]{SimSun}
\setCJKfamilyfont{song}[BoldFont=SimSun]{SimSun}
\setCJKfamilyfont{sf}[BoldFont=SimSun]{SimSun}
\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt
\parindent 2em
\definecolor{VerbatimColor}{rgb}{0.95,0.95,0.95}
\setcounter{tocdepth}{3}
\renewcommand\familydefault{\ttdefault}
\renewcommand\CJKfamilydefault{\CJKrmdefault}


\title{MCMTpy\sphinxhyphen{}test}
\date{Jun 28, 2021}
\release{0.1.0a1}
\author{Fu Yin}
\newcommand{\sphinxlogo}{\sphinxincludegraphics{logo-small-cut.png}\par}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\noindent{\hspace*{\fill}\sphinxincludegraphics[width=0.800\linewidth]{{logo}.gif}\hspace*{\fill}}

\begin{sphinxadmonition}{note}{Note:}
\sphinxhref{https://github.com/OUCyf}{Version 0.1.0a1}%
\begin{footnote}[1]\sphinxAtStartFootnote
\sphinxnolinkurl{https://github.com/OUCyf}
%
\end{footnote}
is the currently release.
\end{sphinxadmonition}

This is the documentation for the Python package of \sphinxstylestrong{MCMTpy}, which is python tool for seismic source study.
For further information please see below website:
\begin{itemize}
\item {} 
Github repository of \sphinxstylestrong{MCMTpy}: \sphinxurl{https://github.com/OUCyf}

\end{itemize}

If you use \sphinxstylestrong{MCMTpy} for your research and prepare publications, please citing \sphinxstylestrong{MCMTpy}:
\begin{itemize}
\item {} 
MCMTpy: A Python Package for Simultaneous Inversion of Source Location, Focal Mechanism, and Rupture Directivity.
In prep for Seismological Research Letter.

\end{itemize}


\chapter{Contents:}
\label{\detokenize{index:contents}}

\section{Installation}
\label{\detokenize{installation:installation}}\label{\detokenize{installation::doc}}
\begin{sphinxShadowBox}
\begin{itemize}
\item {} 
\phantomsection\label{\detokenize{installation:id1}}{\hyperref[\detokenize{installation:dependencies}]{\sphinxcrossref{Dependencies}}}

\item {} 
\phantomsection\label{\detokenize{installation:id2}}{\hyperref[\detokenize{installation:quick-installation}]{\sphinxcrossref{Quick installation}}}

\item {} 
\phantomsection\label{\detokenize{installation:id3}}{\hyperref[\detokenize{installation:source-installation}]{\sphinxcrossref{Source installation}}}

\item {} 
\phantomsection\label{\detokenize{installation:id4}}{\hyperref[\detokenize{installation:parallel-installation-for-future-version}]{\sphinxcrossref{Parallel installation (for future version)}}}
\begin{itemize}
\item {} 
\phantomsection\label{\detokenize{installation:id5}}{\hyperref[\detokenize{installation:install-pyfk}]{\sphinxcrossref{1. Install pyfk}}}

\item {} 
\phantomsection\label{\detokenize{installation:id6}}{\hyperref[\detokenize{installation:install-the-hdf5-parallel-version}]{\sphinxcrossref{2. Install the HDF5 parallel version}}}

\item {} 
\phantomsection\label{\detokenize{installation:id7}}{\hyperref[\detokenize{installation:install-the-h5py-parallel-version}]{\sphinxcrossref{3. Install the h5py parallel version}}}

\item {} 
\phantomsection\label{\detokenize{installation:id8}}{\hyperref[\detokenize{installation:install-pyasdf-parallel-version}]{\sphinxcrossref{1. Install pyasdf parallel version}}}

\item {} 
\phantomsection\label{\detokenize{installation:id9}}{\hyperref[\detokenize{installation:install-mcmtpy-parallel-version}]{\sphinxcrossref{5. Install MCMTpy parallel version}}}

\end{itemize}

\item {} 
\phantomsection\label{\detokenize{installation:id10}}{\hyperref[\detokenize{installation:reference-installation-blog}]{\sphinxcrossref{Reference Installation Blog}}}

\end{itemize}
\end{sphinxShadowBox}

\begin{sphinxadmonition}{note}{Note:}
🚨 \sphinxstylestrong{This package is still undergoing development.} 🚨
\begin{quote}

It is not recommended use \sphinxstylestrong{Parallel installation}, because it’s somewhat complicated and
prepared for the future version for parallel reading of data. Now use \sphinxstylestrong{Quick installation} or
\sphinxstylestrong{Source installation}, you can also run \sphinxcode{\sphinxupquote{MCMTpy}} in parallel. Please note that the test
is performed on \sphinxstylestrong{macOS Big Sur (11.2.1)}, so it could be slightly different for other OS.
\end{quote}
\end{sphinxadmonition}


\subsection{Dependencies}
\label{\detokenize{installation:dependencies}}
The package \sphinxcode{\sphinxupquote{MCMTpy}} runs on Unix\sphinxhyphen{}like systems including Mac and Linux. Package need
\sphinxstylestrong{Python 3.6 or greater}, but python 3.9 is not supported for \sphinxcode{\sphinxupquote{pyfk}}. It depends on the
following Python modules:
\begin{itemize}
\item {} 
\sphinxcode{\sphinxupquote{numpy>=1.14}}

\item {} 
\sphinxcode{\sphinxupquote{tqdm>=4.19.4}}

\item {} 
\sphinxcode{\sphinxupquote{matplotlib<=3.1.1}}

\item {} 
\sphinxcode{\sphinxupquote{mpi4py}}

\item {} 
\sphinxcode{\sphinxupquote{obspy}}

\item {} 
\sphinxcode{\sphinxupquote{pyfk}}

\item {} 
\sphinxcode{\sphinxupquote{pyasdf}}

\item {} 
\sphinxcode{\sphinxupquote{json5}}

\end{itemize}

For parallel:
\begin{itemize}
\item {} 
\sphinxhref{https://docs.h5py.org/en/stable/build.html}{h5py}%
\begin{footnote}[2]\sphinxAtStartFootnote
\sphinxnolinkurl{https://docs.h5py.org/en/stable/build.html}
%
\end{footnote}

\end{itemize}

For data preprocessing and visualization:
\begin{itemize}
\item {} 
\sphinxhref{https://www.pygmt.org/latest/install.html}{pygmt}%
\begin{footnote}[3]\sphinxAtStartFootnote
\sphinxnolinkurl{https://www.pygmt.org/latest/install.html}
%
\end{footnote}

\end{itemize}

We recommend to use \sphinxhref{https://www.anaconda.com/}{anaconda}%
\begin{footnote}[4]\sphinxAtStartFootnote
\sphinxnolinkurl{https://www.anaconda.com/}
%
\end{footnote} as your python environment, and
use \sphinxhref{https://docs.conda.io/en/latest/}{conda}%
\begin{footnote}[5]\sphinxAtStartFootnote
\sphinxnolinkurl{https://docs.conda.io/en/latest/}
%
\end{footnote} and \sphinxhref{https://pypi.org/project/pip/}{pip}%
\begin{footnote}[6]\sphinxAtStartFootnote
\sphinxnolinkurl{https://pypi.org/project/pip/}
%
\end{footnote}
to install those librarys.


\subsection{Quick installation}
\label{\detokenize{installation:quick-installation}}
Firstly, make sure \sphinxstylestrong{Anaconda} has been installed, then:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} conda create \PYGZhy{}n MCMTpy  \PYG{n+nv}{python}\PYG{o}{=}\PYG{l+m}{3}.8 \PYG{n+nv}{numpy}\PYG{o}{=}\PYG{l+m}{1}.16 \PYG{n+nv}{matplotlib}\PYG{o}{=}\PYG{l+m}{3}.1.1 mpi4py obspy pyasdf json5 tqdm
\PYGZdl{} conda activate MCMTpy
\PYGZdl{} pip install pyfk
\PYGZdl{} pip install MCMTpy
\end{sphinxVerbatim}

Some errors may occurred of that pyfk not support the new version of \sphinxcode{\sphinxupquote{cysignals}}, please:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} conda uninstall cysignals
\PYGZdl{} pip install \PYG{n+nv}{cysignals}\PYG{o}{=}\PYG{o}{=}\PYG{l+m}{1}.10.2
\PYGZdl{} pip install pyfk
\end{sphinxVerbatim}

Successful installation will generate an executable program \sphinxcode{\sphinxupquote{MCMTpy}} under the anaconda environment path:
\sphinxstyleemphasis{/Users/user/opt/anaconda3/bin}. And run following code to check the installation:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} MCMTpy \PYGZhy{}\PYGZhy{}help
\end{sphinxVerbatim}


\subsection{Source installation}
\label{\detokenize{installation:source-installation}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} git clone https://github.com/OUCyf/MCMTpy.git
\PYGZdl{} \PYG{n+nb}{cd} MCMTpy
\PYGZdl{} python setup.py install
\end{sphinxVerbatim}


\subsection{Parallel installation (for future version)}
\label{\detokenize{installation:parallel-installation-for-future-version}}

\subsubsection{1. Install pyfk}
\label{\detokenize{installation:install-pyfk}}
Firstly, make sure \sphinxstylestrong{Anaconda} has been installed, then:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} conda create \PYGZhy{}n MCMTpy  \PYG{n+nv}{python}\PYG{o}{=}\PYG{l+m}{3}.8 \PYG{n+nv}{numpy}\PYG{o}{=}\PYG{l+m}{1}.16 obspy
\PYGZdl{} conda activate MCMTpy
\PYGZdl{} pip install pyfk
\end{sphinxVerbatim}

Some errors may occurred of that pyfk not support the new version of \sphinxcode{\sphinxupquote{cysignals}}, please:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} conda uninstall cysignals
\PYGZdl{} pip install \PYG{n+nv}{cysignals}\PYG{o}{=}\PYG{o}{=}\PYG{l+m}{1}.10.2
\PYGZdl{} pip install pyfk
\end{sphinxVerbatim}

🚨 \sphinxstylestrong{Make sure the new environment does not include the following packages that we will install below:} 🚨


\subsubsection{2. Install the HDF5 parallel version}
\label{\detokenize{installation:install-the-hdf5-parallel-version}}\begin{itemize}
\item {} 
First, make sure \sphinxstylestrong{openmpi} or other \sphinxstylestrong{MPI} program has been installed, preferably source code installed.
You can use \sphinxstylestrong{which mpicc} to get the installation’s path.

\item {} 
Activate the MCMTpy environment, and uninstall the \sphinxcode{\sphinxupquote{mpi4py}} package in this environment (if it have).
Then use \sphinxcode{\sphinxupquote{pip}} install the \sphinxcode{\sphinxupquote{mpi4py}} package not \sphinxcode{\sphinxupquote{conda}}.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} conda uninstall mpi4py
\PYGZdl{} pip install mpi4py
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}
When you use \sphinxcode{\sphinxupquote{pip}} install \sphinxcode{\sphinxupquote{mpi4py}}, it will use the \sphinxstylestrong{mpicc} in your system. But if you use \sphinxcode{\sphinxupquote{conda}}
to do the installation, it resolves the dependent environment itself and install conda’s mpicc in your
environment which will cause problems for subsequent installations due to the not source code compilation
of \sphinxstylestrong{MPI}. After installing \sphinxcode{\sphinxupquote{mpi4py}}, you can use \sphinxstylestrong{which mpicc} to check whether it is a system
mpicc or a conda mpicc.
\end{sphinxadmonition}
\begin{itemize}
\item {} 
Then you need to install the parallel version of \sphinxhref{https://www.hdfgroup.org/downloads/hdf5/}{HDF5}%
\begin{footnote}[7]\sphinxAtStartFootnote
\sphinxnolinkurl{https://www.hdfgroup.org/downloads/hdf5/}
%
\end{footnote}. Download the source
package, compile and install the parallel version to your path.
Your system may already have HDF5 installed. Software such as GMT relies on the HDF5 package, so use \sphinxstylestrong{h5cc\sphinxhyphen{}showconfig}
to see more information about installation, note that h5cc is usually not shown in parallel. We do not want to uninstall
the existing version of HDF5 on our system. This does not conflict with our subsequent installation of the parallel
version of HDF5, as long as we specify the installation path of the parallel version.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} chmod \PYG{l+m}{777} ./configure  \PYG{c+c1}{\PYGZsh{} enable read/write access}
\PYGZdl{} ./configure \PYGZhy{}\PYGZhy{}enable\PYGZhy{}parallel \PYGZhy{}\PYGZhy{}enable\PYGZhy{}shared \PYGZhy{}\PYGZhy{}prefix\PYG{o}{=}/your/path/of/hdf5\PYGZus{}dir/
\PYGZdl{} make
\PYGZdl{} make check
\PYGZdl{} make install
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
After the installation, the executable program will be generated in \sphinxstylestrong{./bin} path of your \sphinxstylestrong{hdf5\_dir} directory.
\sphinxstylestrong{h5pcc} will be generated due to the parallel installation, similar to the \sphinxstylestrong{h5cc} will be generated by the non\sphinxhyphen{}parallel
installation. Check the installation version information:

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} h5pcc \PYGZhy{}showconfig
\end{sphinxVerbatim}


\subsubsection{3. Install the h5py parallel version}
\label{\detokenize{installation:install-the-h5py-parallel-version}}\begin{itemize}
\item {} 
Before installing \sphinxcode{\sphinxupquote{h5py}}, you need to uninstall both \sphinxcode{\sphinxupquote{hdf5}} and \sphinxcode{\sphinxupquote{h5py}} in your environment, and then download
h5py <\sphinxurl{https://github.com/h5py/h5py}> and compile the source code. You need to specify the path of \sphinxstylestrong{HDF5} and \sphinxstylestrong{CC}.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} \PYG{n+nb}{export} \PYG{n+nv}{CC}\PYG{o}{=}/path/to/mpicc   \PYG{c+c1}{\PYGZsh{} do not use conda\PYGZsq{}s mpicc}
\PYGZdl{} \PYG{n+nb}{echo} \PYGZpc{}CC
\PYGZdl{} \PYG{n+nb}{export} \PYG{n+nv}{HDF5\PYGZus{}MPI}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}ON\PYGZdq{}}
\PYGZdl{} \PYG{n+nb}{export} \PYG{n+nv}{HDF5\PYGZus{}DIR}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/your/path/of/hdf5\PYGZus{}dir/\PYGZdq{}}
\PYGZdl{} pip install .
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
Check the installation version information (download the \sphinxstylestrong{demo2.py} on h5py):

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}*\PYGZhy{} coding: utf\PYGZhy{}8 \PYGZhy{}*\PYGZhy{}}

\PYG{k+kn}{from} \PYG{n+nn}{mpi4py} \PYG{k+kn}{import} \PYG{n}{MPI}
\PYG{k+kn}{import} \PYG{n+nn}{h5py}

\PYG{n}{rank} \PYG{o}{=} \PYG{n}{MPI}\PYG{o}{.}\PYG{n}{COMM\PYGZus{}WORLD}\PYG{o}{.}\PYG{n}{rank}  \PYG{c+c1}{\PYGZsh{} The process ID (integer 0\PYGZhy{}3 for 4\PYGZhy{}process run)}

\PYG{n}{f} \PYG{o}{=} \PYG{n}{h5py}\PYG{o}{.}\PYG{n}{File}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{parallel\PYGZus{}test.hdf5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{driver}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mpio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{comm}\PYG{o}{=}\PYG{n}{MPI}\PYG{o}{.}\PYG{n}{COMM\PYGZus{}WORLD}\PYG{p}{)}

\PYG{n}{dset} \PYG{o}{=} \PYG{n}{f}\PYG{o}{.}\PYG{n}{create\PYGZus{}dataset}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{test}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{)}\PYG{p}{,} \PYG{n}{dtype}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{i}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{dset}\PYG{p}{[}\PYG{n}{rank}\PYG{p}{]} \PYG{o}{=} \PYG{n}{rank}

\PYG{n}{f}\PYG{o}{.}\PYG{n}{close}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

Run the program:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} mpiexec \PYGZhy{}n 4 python demo2.py
\end{sphinxVerbatim}

Looking at the file with \sphinxcode{\sphinxupquote{h5dump}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} h5dump parallel\PYGZus{}test.hdf5
HDF5 \PYGZdq{}parallel\PYGZus{}test.hdf5\PYGZdq{} \PYGZob{}
GROUP \PYGZdq{}/\PYGZdq{} \PYGZob{}
   DATASET \PYGZdq{}test\PYGZdq{} \PYGZob{}
      DATATYPE  H5T\PYGZus{}STD\PYGZus{}I32LE
      DATASPACE  SIMPLE \PYGZob{} ( 4 ) / ( 4 ) \PYGZcb{}
      DATA \PYGZob{}
      (0): 0, 1, 2, 3
      \PYGZcb{}
   \PYGZcb{}
\PYGZcb{}
\PYGZcb{}
\end{sphinxVerbatim}


\subsubsection{1. Install pyasdf parallel version}
\label{\detokenize{installation:install-pyasdf-parallel-version}}\begin{itemize}
\item {} 
After the above steps are completed sucessful, you can directly use \sphinxcode{\sphinxupquote{pip}} to install \sphinxcode{\sphinxupquote{pyasdf}}

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} pip install pyasdf
\PYGZdl{} python \PYGZhy{}c \PYG{l+s+s2}{\PYGZdq{}import pyasdf; pyasdf.print\PYGZus{}sys\PYGZus{}info()\PYGZdq{}}   \PYG{c+c1}{\PYGZsh{} (check for a parallel version)}
\end{sphinxVerbatim}


\subsubsection{5. Install MCMTpy parallel version}
\label{\detokenize{installation:install-mcmtpy-parallel-version}}\begin{itemize}
\item {} 
Finally, you can install the parallel version of MCMTpy.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} pip install MCMTpy        \PYG{c+c1}{\PYGZsh{} or python setup.py install}
\PYGZdl{} pip uninstall MCMTpy      \PYG{c+c1}{\PYGZsh{} uninstall}
\end{sphinxVerbatim}


\subsection{Reference Installation Blog}
\label{\detokenize{installation:reference-installation-blog}}\begin{itemize}
\item {} 
\sphinxurl{https://drtiresome.com/2016/08/23/build-and-install-mpi-parallel-hdf5-and-h5py-from-source-on-linux/}

\item {} 
\sphinxurl{https://gist.github.com/kentwait/280aa20e9d8f2c8737b2bec4a49b7c92}

\item {} 
\sphinxurl{https://github.com/h5py/h5py/issues/759}

\item {} 
\sphinxurl{https://seismicdata.github.io/pyasdf/installation.html}

\item {} 
\sphinxurl{https://noise-python.readthedocs.io/en/latest/installation.html}

\item {} 
\sphinxurl{https://docs.h5py.org/en/stable/mpi.html}

\item {} 
\sphinxurl{https://docs.h5py.org/en/stable/build.html}

\item {} 
\sphinxurl{https://github.com/conda-forge/hdf5-feedstock/issues/118}

\item {} 
\sphinxurl{https://distarray.readthedocs.io/en/latest/hdf5-notes.html}

\item {} 
\sphinxurl{https://forum.hdfgroup.org/t/installing-hdf5-ready-version-of-open-mpi/4998}

\end{itemize}


\section{Tutorial}
\label{\detokenize{tutorial:tutorial}}\label{\detokenize{tutorial::doc}}
In this tutorial, we will show some of the key steps in \sphinxstylestrong{MCMTpy} for \sphinxstylestrong{Focal Mechanism Inversion},
including \sphinxstylestrong{DC} (double couple) and \sphinxstylestrong{MT} (moment tensor) inversion (not in now).


\subsection{About ASDF format}
\label{\detokenize{tutorial:about-asdf-format}}
The users who are interested in the details of \sphinxstylestrong{ASDF format} are referred to the following publication.
And the pyasdf Github repository \sphinxurl{https://github.com/SeismicData/pyasdf}.
\begin{itemize}
\item {} 
Krischer, L., Smith, J., Lei, W., Lefebvre, M., Ruan, Y., de Andrade, E.S., Podhorszki, N., Bozdağ, E.
and Tromp, J., 2016. An adaptable seismic data format. Geophysical Supplements to the Monthly Notices
of the Royal Astronomical Society, 207(2), 1003\sphinxhyphen{}1011.

\end{itemize}

You can also find some useful examples about \sphinxcode{\sphinxupquote{pyasdf}} in \sphinxhref{https://noise-python.readthedocs.io/en/latest/examples.html}{NoisePy.}%
\begin{footnote}[8]\sphinxAtStartFootnote
\sphinxnolinkurl{https://noise-python.readthedocs.io/en/latest/examples.html}
%
\end{footnote}


\subsection{About pyfk}
\label{\detokenize{tutorial:about-pyfk}}
The users who are interested in the details of \sphinxstylestrong{pyfk} are referred to the pyfk Github
repository \sphinxurl{https://github.com/ziyixi/pyfk}.


\subsection{Short tutorial}
\label{\detokenize{tutorial:short-tutorial}}
MCMTpy stores all the parameter information in four JSON files: \sphinxstylestrong{build\_GFs.json}, \sphinxstylestrong{syn.json},
\sphinxstylestrong{sample.json} and \sphinxstylestrong{plot.json}, and you can find those json\sphinxhyphen{}files in path \sphinxstyleemphasis{./MCMTpy\sphinxhyphen{}master/jsons/}.
For parameters choosing, please refer to \sphinxstylestrong{Detailed tutorial}. The steps to do inversion process are:

\sphinxstylestrong{1. Calculate green function database}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} MCMTpy build\PYGZus{}GFs pyfk  \PYGZhy{}c ./build\PYGZus{}GFs.json
\PYGZdl{} mpirun \PYGZhy{}n 4 MCMTpy build\PYGZus{}GFs pyfk  \PYGZhy{}c ./build\PYGZus{}GFs.json        \PYGZsh{} parallel
\end{sphinxVerbatim}

\sphinxstylestrong{2. Synthesize the test data}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} MCMTpy  syn pyfk  \PYGZhy{}c ./syn.json
\end{sphinxVerbatim}

\sphinxstylestrong{3. Inversion of focal mechanism}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} MCMTpy  sample MH  \PYGZhy{}c ./sample.json
\PYGZdl{} mpirun \PYGZhy{}n 4  MCMTpy  sample MH  \PYGZhy{}c ./sample.json        \PYGZsh{} parallel
\end{sphinxVerbatim}

\sphinxstylestrong{4. Result visualization}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} MCMTpy plot pyfk \PYGZhy{}c plot.json
\end{sphinxVerbatim}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{station_location}.png}\hspace*{\fill}}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{hist}.png}\hspace*{\fill}}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{misfit}.png}\hspace*{\fill}}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{alpha}.png}\hspace*{\fill}}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{waveform}.png}\hspace*{\fill}}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{beachball}.png}\hspace*{\fill}}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{Decompose}.png}\hspace*{\fill}}


\section{Tutorial\_Detailed}
\label{\detokenize{tutorial_detailed:tutorial-detailed}}\label{\detokenize{tutorial_detailed::doc}}
More details on \sphinxstylestrong{MCMTpy} for data processing, parameters choosing can be found in following documentations,
and the \sphinxstylestrong{jupyter notebook} can be find in \sphinxstyleemphasis{./MCMTpy\sphinxhyphen{}master/data/example\_yunnan/Jupyter\_notebook}:


\subsection{Calculate Green Function Database}
\label{\detokenize{tutorials/S1_Build_GFs:calculate-green-function-database}}\label{\detokenize{tutorials/S1_Build_GFs::doc}}
\begin{sphinxShadowBox}
\begin{itemize}
\item {} 
\phantomsection\label{\detokenize{tutorials/S1_Build_GFs:id1}}{\hyperref[\detokenize{tutorials/S1_Build_GFs:station-and-source}]{\sphinxcrossref{Station and Source}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S1_Build_GFs:id2}}{\hyperref[\detokenize{tutorials/S1_Build_GFs:mpi}]{\sphinxcrossref{MPI}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S1_Build_GFs:id3}}{\hyperref[\detokenize{tutorials/S1_Build_GFs:path}]{\sphinxcrossref{Path}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S1_Build_GFs:id4}}{\hyperref[\detokenize{tutorials/S1_Build_GFs:sourcemodel}]{\sphinxcrossref{SourceModel}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S1_Build_GFs:id5}}{\hyperref[\detokenize{tutorials/S1_Build_GFs:seismodel}]{\sphinxcrossref{SeisModel}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S1_Build_GFs:id6}}{\hyperref[\detokenize{tutorials/S1_Build_GFs:config}]{\sphinxcrossref{Config}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S1_Build_GFs:id7}}{\hyperref[\detokenize{tutorials/S1_Build_GFs:logging-file}]{\sphinxcrossref{Logging file}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S1_Build_GFs:id8}}{\hyperref[\detokenize{tutorials/S1_Build_GFs:example}]{\sphinxcrossref{Example}}}

\end{itemize}
\end{sphinxShadowBox}
\begin{itemize}
\item {} 
The first step of \sphinxstylestrong{MCMTpy} is to build Green’s function database. All parameters are written into a JSON
file named \sphinxstylestrong{build\_GFs.json}. Some brief descriptions of the parameters are included here following the
definination.

\item {} 
We do not recommend using relative paths because of the possibility of errors. \sphinxstylestrong{Absolute paths} are preferred.

\item {} 
We used \sphinxcode{\sphinxupquote{ASDF}} seismic data format to manage Green Function database, which is convenient to locally build up
a database of pre\sphinxhyphen{}processed waveforms. ASDF file greatly reduces the number of green functions files,
and a single ASDF file can replace thousands of green function files which may threw us into confusion
in the management process. We store the Green‘s functions corresponding to \sphinxstylestrong{Event\_ID} (\sphinxstylestrong{QuakeML})
in \sphinxstylestrong{“Waveforms”} of ASDF data. In the \sphinxstylestrong{“Labels”} of \sphinxstylestrong{“Waveforms”} , we store the phase (P and S) travel times
which can be computed in advance by a given velocity model.

\item {} 
The general structure of MCMTpy stores Green‘s function with ASDF file format shown in the image below.

\end{itemize}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{Green_Function_Database}.png}\hspace*{\fill}}
\begin{itemize}
\item {} 
You can also find some useful information about parameters in refers to \sphinxhref{https://github.com/ziyixi/pyfk}{pyfk}%
\begin{footnote}[9]\sphinxAtStartFootnote
\sphinxnolinkurl{https://github.com/ziyixi/pyfk}
%
\end{footnote}.

\end{itemize}


\subsubsection{Station and Source}
\label{\detokenize{tutorials/S1_Build_GFs:station-and-source}}
\sphinxcode{\sphinxupquote{Database\_mode}}
\begin{itemize}
\item {} 
Set to be \sphinxstylestrong{.true.} when you want to compute the Green’s function library for some region. For real
examples, the GF databases may require up to several GBs of free disc space.
In addition you need to set the following parameters correctly:

\sphinxcode{\sphinxupquote{Source\_depth\_min}},
\sphinxcode{\sphinxupquote{Source\_depth\_max}},
\sphinxcode{\sphinxupquote{Source\_depth\_spacing}},
\sphinxcode{\sphinxupquote{Station\_distance\_radius\_min}},
\sphinxcode{\sphinxupquote{Station\_distance\_radius\_max}},
\sphinxcode{\sphinxupquote{Station\_distance\_spacing}},
\sphinxcode{\sphinxupquote{Source\_name}},
\sphinxcode{\sphinxupquote{Network\_name}},
\sphinxcode{\sphinxupquote{Station\_name}},
\sphinxcode{\sphinxupquote{Station\_depth\_reference}}

\item {} 
Set to be \sphinxstylestrong{.false.} when you want to calculate the Green’s function for stations at which the source is given.
You must provide an \sphinxcode{\sphinxupquote{.txt}} file named Source\_Station\_info.txt, which including the longitude latitude and depth
information of the source and station. Different sources should be separated by blank lines.

\item {} 
Source\_Station\_info.txt format.

{[}source\_name{]} {[}source\_lat{]}    {[}source\_lon{]}    {[}source\_depth{]}

{[}network\_name{]}        {[}station\_name{]}  {[}station\_lat{]}   {[}source\_lon{]}    {[}station\_depth{]}

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
source\PYGZus{}1  25.58 99.86  1
YN EYA 26.108 99.947 0
YN YUL 25.885 99.371 0

source\PYGZus{}2  25.58 99.86  2
YN EYA 26.108 99.947 0
YN YUL 25.885 99.371 0
XG CFT 25.848 100.517 0
YN BAS 25.118 99.146 0

source\PYGZus{}3  25.58 99.86  3
YN WES 23.372 104.253 0
YN MLP 23.128 104.702 0
YN FUN 23.624 105.620 0
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{Source\_depth\_min}}
\begin{itemize}
\item {} 
The minimum source depth in Green’s function databases (km).

\end{itemize}

\sphinxcode{\sphinxupquote{Source\_depth\_max}}
\begin{itemize}
\item {} 
The maximum source depth in Green’s function databases (km).

\end{itemize}

\sphinxcode{\sphinxupquote{Source\_depth\_spacing}}
\begin{itemize}
\item {} 
Interval of source depths in Green’s function databases (km).

\end{itemize}

\sphinxcode{\sphinxupquote{Station\_distance\_radius\_min}}
\begin{itemize}
\item {} 
The minimum distance of the station in Green’s function databases (km or degree, depend by \sphinxcode{\sphinxupquote{degrees}}).

\end{itemize}

\sphinxcode{\sphinxupquote{Station\_distance\_radius\_max}}
\begin{itemize}
\item {} 
The maximum distance of the station in Green’s function databases (km or degree, depend by \sphinxcode{\sphinxupquote{degrees}}).

\end{itemize}

\sphinxcode{\sphinxupquote{Station\_distance\_spacing}}
\begin{itemize}
\item {} 
Horizontal spacing interval in Green’s function databases (km or degree, depend by \sphinxcode{\sphinxupquote{degrees}}).

\end{itemize}

\sphinxcode{\sphinxupquote{Source\_name}}
\begin{itemize}
\item {} 
Source name in Green’s function databases, default value is \sphinxstyleemphasis{source}, please do not change.
Only lowercase letters are supported.

\end{itemize}

\sphinxcode{\sphinxupquote{Network\_name}}
\begin{itemize}
\item {} 
Network name in Green’s function databases, default value is \sphinxstyleemphasis{NET}, please do not change.

\end{itemize}

\sphinxcode{\sphinxupquote{Station\_name}}
\begin{itemize}
\item {} 
Station name in Green’s function databases, default value is \sphinxstyleemphasis{STA}, please do not change.

\end{itemize}

\sphinxcode{\sphinxupquote{Station\_depth\_reference}}
\begin{itemize}
\item {} 
Depth of all virtual stations (km).

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
When \sphinxcode{\sphinxupquote{Database\_mode}} = \sphinxstylestrong{.false.}, depths can vary from station to station. But when set to be \sphinxstylestrong{.true},
all stations must use the same depth \sphinxcode{\sphinxupquote{Station\_depth\_reference}}.
\end{sphinxadmonition}


\subsubsection{MPI}
\label{\detokenize{tutorials/S1_Build_GFs:mpi}}
\sphinxcode{\sphinxupquote{MPI\_n}}
\begin{itemize}
\item {} 
CPU number. When \sphinxcode{\sphinxupquote{Database\_mode}} = \sphinxstylestrong{.false.}, the number of call cores should be less than or equal to the number of source.
But when set to be \sphinxstylestrong{.true}, there are no limits.

\end{itemize}


\subsubsection{Path}
\label{\detokenize{tutorials/S1_Build_GFs:path}}
\sphinxcode{\sphinxupquote{DATADIR}}
\begin{itemize}
\item {} 
The output path of the Green function databases.

\end{itemize}

\sphinxcode{\sphinxupquote{DATADIR\_splits}}
\begin{itemize}
\item {} 
A subfolder under \sphinxcode{\sphinxupquote{DATADIR}} for Green’s function. Please keep the path relative to \sphinxcode{\sphinxupquote{DATADIR}}.

\end{itemize}


\subsubsection{SourceModel}
\label{\detokenize{tutorials/S1_Build_GFs:sourcemodel}}
\sphinxcode{\sphinxupquote{source\_mechanism}}
\begin{itemize}
\item {} 
Focal mechanism, not used. Please set it to \sphinxstylestrong{.null.}.

\end{itemize}

\sphinxcode{\sphinxupquote{srcType}}
\begin{itemize}
\item {} 
The type of Green’s function, dc(double\sphinxhyphen{}couple) sf(single\sphinxhyphen{}couple) ep(explosion). Please set it to \sphinxstylestrong{.dc.}.

\end{itemize}


\subsubsection{SeisModel}
\label{\detokenize{tutorials/S1_Build_GFs:seismodel}}
\sphinxcode{\sphinxupquote{Velocity\_model}}
\begin{itemize}
\item {} 
Path to the velocity model file. And the format:

thick(km), vs(km/s), vp(km/s), density(g/cm\textasciicircum{}3), Qs, Qp

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
5.01000000   3.17601610   5.41925121   2.50000000   600.00000000   1200.00000000   
5.01000000   3.36477536   5.67947907   2.55000000   600.00000000   1200.00000000   
5.01000000   3.52147424   5.93255556   2.60000000   600.00000000   1200.00000000   
5.01000000   3.55152174   6.00984300   2.65000000   600.00000000   1200.00000000   
5.01000000   3.54084541   6.02592110   2.70000000   600.00000000   1250.00000000   
5.01000000   3.58840419   6.14793478   2.75000000   650.00000000   1300.00000000   
5.01000000   3.75369968   6.48572061   2.80000000   700.00000000   1350.00000000   
5.01000000   3.94361514   6.86566667   2.90000000   750.00000000   1400.00000000   
10.01000000   4.12710548   7.20229388   3.00000000   800.00000000   1500.00000000   
10.01000000   4.30825765   7.55049678   3.10000000   850.00000000   1600.00000000   
10.01000000   4.38069968   7.72566425   3.20000000   850.00000000   1700.00000000   
90.00000000   4.50000000   7.80000000   3.27000000   900.00000000   1800.00000000   
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{flattening}}
\begin{itemize}
\item {} 
Set the flatten status of the velocity model, \sphinxstylestrong{.true.} or \sphinxstylestrong{.false.}.

\end{itemize}


\subsubsection{Config}
\label{\detokenize{tutorials/S1_Build_GFs:config}}
The following parameters explanation refers to \sphinxcode{\sphinxupquote{pyfk}} <\sphinxurl{https://github.com/ziyixi/pyfk}>.

\sphinxcode{\sphinxupquote{npt}}
\begin{itemize}
\item {} 
The sampling points is a multiple of 2.

\end{itemize}

\sphinxcode{\sphinxupquote{dt}}
\begin{itemize}
\item {} 
Sampling interval in seconds

\end{itemize}

\sphinxcode{\sphinxupquote{degrees}}
\begin{itemize}
\item {} 
Use degrees instead of km, defaults to \sphinxstylestrong{.true.}. Only when \sphinxcode{\sphinxupquote{Database\_mode}} = \sphinxstylestrong{.true.}, it can be changed to \sphinxstylestrong{.false.}

\end{itemize}

\sphinxcode{\sphinxupquote{taper}}
\begin{itemize}
\item {} 
Taper applies a low\sphinxhyphen{}pass cosine filter at fc=(1\sphinxhyphen{}taper)*f\_Niquest, defaults to 0.3.

\end{itemize}

\sphinxcode{\sphinxupquote{filter}}
\begin{itemize}
\item {} 
Apply a high\sphinxhyphen{}pass filter with a cosine transition zone between freq. f1 and f2 in Hz, defaults to (0, 0).

\end{itemize}

\sphinxcode{\sphinxupquote{dk}}
\begin{itemize}
\item {} 
The non\sphinxhyphen{}dimensional sampling interval of wavenumber, defaults to 0.3.

\end{itemize}

\sphinxcode{\sphinxupquote{smth}}
\begin{itemize}
\item {} 
Makes the final sampling interval to be dt/smth, defaults to 1.

\end{itemize}

\sphinxcode{\sphinxupquote{pmin}}
\begin{itemize}
\item {} 
The min slownesses in term of 1/vs\_at\_the\_source, defaults to 0.

\end{itemize}

\sphinxcode{\sphinxupquote{pmax}}
\begin{itemize}
\item {} 
The max slownesses in term of 1/vs\_at\_the\_source, defaults to 1.

\end{itemize}

\sphinxcode{\sphinxupquote{kmax}}
\begin{itemize}
\item {} 
The kmax at zero frequency in term of 1/hs, defaults to 15.

\end{itemize}

\sphinxcode{\sphinxupquote{rdep}}
\begin{itemize}
\item {} 
Not used now. Please keep the default values of the parameters, defaults to 0 in km.

\end{itemize}

\sphinxcode{\sphinxupquote{updn}}
\begin{itemize}
\item {} 
The “up” for up\sphinxhyphen{}going wave only, “down” for down\sphinxhyphen{}going wave only, “all” for both “up” and “down”, defaults to “all”.

\end{itemize}

\sphinxcode{\sphinxupquote{samples\_before\_first\_arrival}}
\begin{itemize}
\item {} 
The number of points before the first arrival, defaults to 50.

\end{itemize}


\subsubsection{Logging file}
\label{\detokenize{tutorials/S1_Build_GFs:logging-file}}\begin{itemize}
\item {} 
\sphinxstylestrong{MCMTpy} will generates 2 logging files when it builds GFs datebase, that is \sphinxstylestrong{prepro\_para\_info.txt} and
\sphinxstylestrong{write\_Source\_Station\_info\_MPI}. They record all the parameter information of GFs datebase. You can find them
in \sphinxcode{\sphinxupquote{DATADIR}} path.

\end{itemize}


\subsubsection{Example}
\label{\detokenize{tutorials/S1_Build_GFs:example}}\begin{itemize}
\item {} 
The \sphinxstylestrong{example\_path} need to de changed to your path, and run this notebook to set \sphinxstylestrong{build\_GFs.json} file.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}*\PYGZhy{} coding: utf\PYGZhy{}8 \PYGZhy{}*\PYGZhy{}}

\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{sys}
\PYG{k+kn}{import} \PYG{n+nn}{json5}


\PYG{c+c1}{\PYGZsh{} The root directory of the project}
\PYG{n}{example\PYGZus{}path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/Users/yf/3.Project/8.MCMTpy/MCMTpy\PYGZhy{}master/data/example\PYGZus{}yunnan}\PYG{l+s+s1}{\PYGZsq{}}


\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} we expect no parameters need to be changed below}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} 1. get notebook path}
\PYG{n}{notebook\PYGZus{}path} \PYG{o}{=} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{path}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{n}{notebook\PYGZus{}path}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 2. change path to Green\PYGZus{}Funcs}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../Green\PYGZus{}Funcs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{os}\PYG{o}{.}\PYG{n}{listdir}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 3. show build\PYGZus{}GFs.json }
\PYG{n}{filename} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{build\PYGZus{}GFs.json}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{filename}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{encoding}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{utf\PYGZhy{}8}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f1}\PYG{p}{:}
    \PYG{n}{gfs\PYGZus{}json}\PYG{o}{=}\PYG{n}{json5}\PYG{o}{.}\PYG{n}{load}\PYG{p}{(}\PYG{n}{f1}\PYG{p}{)}
\PYG{n}{f1}\PYG{o}{.}\PYG{n}{close}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 4. change parameters with absolute path}
\PYG{n}{gfs\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Source\PYGZus{}Station\PYGZus{}info}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Green\PYGZus{}Funcs/Source\PYGZus{}Station\PYGZus{}info.txt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{gfs\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{DATADIR}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Green\PYGZus{}Funcs/GFs1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{gfs\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{DATADIR\PYGZus{}splits}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Green\PYGZus{}Funcs1/GFs1/GFs\PYGZus{}splits}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{gfs\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Velocity\PYGZus{}model}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=}  \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{v\PYGZus{}model/v\PYGZus{}model\PYGZus{}yunnan.txt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}        
\PYG{n}{gfs\PYGZus{}json\PYGZus{}new} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Green\PYGZus{}Funcs/build\PYGZus{}GFs\PYGZus{}new.json}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{gfs\PYGZus{}json\PYGZus{}new}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f2}\PYG{p}{:}
    \PYG{n}{json5}\PYG{o}{.}\PYG{n}{dump}\PYG{p}{(}\PYG{n}{gfs\PYGZus{}json}\PYG{p}{,} \PYG{n}{f2}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{f2}\PYG{o}{.}\PYG{n}{close}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} !mpirun \PYGZhy{}n 4 MCMTpy build\PYGZus{}GFs pyfk \PYGZhy{}c build\PYGZus{}GFs\PYGZus{}new.json  \PYGZgt{} gfs.log}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
Now you can run MCMTpy in bash:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} mpirun \PYGZhy{}n 4 MCMTpy build\PYGZus{}GFs pyfk \PYGZhy{}c build\PYGZus{}GFs\PYGZus{}new.json  \PYGZgt{} gfs.log
\end{sphinxVerbatim}

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
Please follow the above parameter instructions and set all parameters correctly before running the program.
Otherwise, it is easy to report an error!
\end{sphinxadmonition}


\subsection{Synthesize the Test Data}
\label{\detokenize{tutorials/S2_Syn_Waveform:synthesize-the-test-data}}\label{\detokenize{tutorials/S2_Syn_Waveform::doc}}
\begin{sphinxShadowBox}
\begin{itemize}
\item {} 
\phantomsection\label{\detokenize{tutorials/S2_Syn_Waveform:id1}}{\hyperref[\detokenize{tutorials/S2_Syn_Waveform:path}]{\sphinxcrossref{Path}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S2_Syn_Waveform:id2}}{\hyperref[\detokenize{tutorials/S2_Syn_Waveform:source}]{\sphinxcrossref{Source}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S2_Syn_Waveform:id3}}{\hyperref[\detokenize{tutorials/S2_Syn_Waveform:station}]{\sphinxcrossref{Station}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S2_Syn_Waveform:id4}}{\hyperref[\detokenize{tutorials/S2_Syn_Waveform:source-time-function}]{\sphinxcrossref{Source Time Function}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S2_Syn_Waveform:id5}}{\hyperref[\detokenize{tutorials/S2_Syn_Waveform:filter}]{\sphinxcrossref{Filter}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S2_Syn_Waveform:id6}}{\hyperref[\detokenize{tutorials/S2_Syn_Waveform:add-noise}]{\sphinxcrossref{Add Noise}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S2_Syn_Waveform:id7}}{\hyperref[\detokenize{tutorials/S2_Syn_Waveform:output}]{\sphinxcrossref{Output}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S2_Syn_Waveform:id8}}{\hyperref[\detokenize{tutorials/S2_Syn_Waveform:example}]{\sphinxcrossref{Example}}}

\end{itemize}
\end{sphinxShadowBox}
\begin{itemize}
\item {} 
The synthesized test data can help us check whether the Green’s function database is correctly calculated.

\item {} 
We do not recommend using relative paths because of the possibility of errors. \sphinxstylestrong{Absolute paths} are preferred.

\end{itemize}


\subsubsection{Path}
\label{\detokenize{tutorials/S2_Syn_Waveform:path}}
\sphinxcode{\sphinxupquote{GFs\_json\_file}}
\begin{itemize}
\item {} 
The path to the Json\sphinxhyphen{}file used to calculate Green Function Database.

\end{itemize}


\subsubsection{Source}
\label{\detokenize{tutorials/S2_Syn_Waveform:source}}
\sphinxcode{\sphinxupquote{srcType}}
\begin{itemize}
\item {} 
The type of \sphinxstyleemphasis{Source}, mt(moment tensor) dc(double\sphinxhyphen{}couple) sf(single\sphinxhyphen{}couple) ep(explosion).

\end{itemize}

\sphinxcode{\sphinxupquote{point}}
\begin{itemize}
\item {} 
The latitude longitude and depth of the source.

\end{itemize}

\sphinxcode{\sphinxupquote{source\_mechanism}}
\begin{itemize}
\item {} 
Focal mechanism.

\item {} 
When \sphinxcode{\sphinxupquote{srcType}} = \sphinxstylestrong{dc}: \sphinxcode{\sphinxupquote{source\_mechanism}} = {[}Mw, Strike, Dip, Rake{]}

\item {} 
When \sphinxcode{\sphinxupquote{srcType}} = \sphinxstylestrong{mt}: \sphinxcode{\sphinxupquote{source\_mechanism}} = {[}Mw, Mxx, Mxy, Mxz, Myy, Myz, Mzz{]}

\end{itemize}


\subsubsection{Station}
\label{\detokenize{tutorials/S2_Syn_Waveform:station}}
\sphinxcode{\sphinxupquote{NET\_STA}}
\begin{itemize}
\item {} 
The information contained in the two\sphinxhyphen{}dimensional list: {[}network\_name{]} {[}station\_name{]}  {[}station\_lat{]}   {[}source\_lon{]}    {[}station\_depth{]}

\end{itemize}


\subsubsection{Source Time Function}
\label{\detokenize{tutorials/S2_Syn_Waveform:source-time-function}}
\sphinxcode{\sphinxupquote{Trapezoid\_stf\_mode}}
\begin{itemize}
\item {} 
Whether to use pyfk provided trapezoid shaped source time function. Set to be \sphinxstylestrong{.true.} you need to set the following parameters correctly:

\sphinxcode{\sphinxupquote{dura}}
\sphinxcode{\sphinxupquote{rise}}
\sphinxcode{\sphinxupquote{delta}}

\end{itemize}

\sphinxcode{\sphinxupquote{dura}}
\begin{itemize}
\item {} 
Duration time (s).

\end{itemize}

\sphinxcode{\sphinxupquote{rise}}
\begin{itemize}
\item {} 
Rise time (s).

\end{itemize}

\sphinxcode{\sphinxupquote{delta}}
\begin{itemize}
\item {} 
The time interval (s).

\end{itemize}

\sphinxcode{\sphinxupquote{Stf\_file}}
\begin{itemize}
\item {} 
Stf\_file should be an \sphinxstylestrong{SAC} file as the source time function when set \sphinxcode{\sphinxupquote{Trapezoid\_stf\_mode}} to be \sphinxstylestrong{.false.}.

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
To read the data from the \sphinxcode{\sphinxupquote{Stf\_file}} file, keep the sampling rate of SAC data consistent with the data and GFs.
\end{sphinxadmonition}


\subsubsection{Filter}
\label{\detokenize{tutorials/S2_Syn_Waveform:filter}}
\sphinxcode{\sphinxupquote{filter\_mode}}
\begin{itemize}
\item {} 
Whether to filter.

\end{itemize}

\sphinxcode{\sphinxupquote{freqmin}}
\begin{itemize}
\item {} 
The minimum frequency of filtering.

\end{itemize}

\sphinxcode{\sphinxupquote{freqmax}}
\begin{itemize}
\item {} 
The maximum frequency of filtering.

\end{itemize}


\subsubsection{Add Noise}
\label{\detokenize{tutorials/S2_Syn_Waveform:add-noise}}
\sphinxcode{\sphinxupquote{Add\_noise}}
\begin{itemize}
\item {} 
Whether add noise to syn.

\end{itemize}

\sphinxcode{\sphinxupquote{noise\_level\_waveform}}
\begin{itemize}
\item {} 
Noise level added to the waveform.

\end{itemize}

\sphinxcode{\sphinxupquote{noise\_level\_arrive\_time}}
\begin{itemize}
\item {} 
Noise level added to the phase time as \sphinxstylestrong{tp} and \sphinxstylestrong{ts}.

\end{itemize}


\subsubsection{Output}
\label{\detokenize{tutorials/S2_Syn_Waveform:output}}
\sphinxcode{\sphinxupquote{Output\_mode}}
\begin{itemize}
\item {} 
Output data or not.

\end{itemize}

\sphinxcode{\sphinxupquote{Output\_path}}
\begin{itemize}
\item {} 
Path of output data

\end{itemize}

\sphinxcode{\sphinxupquote{source\_name}}
\begin{itemize}
\item {} 
Event name of output data, you can set it any way you want. Only lowercase letters are supported.

\end{itemize}

\sphinxcode{\sphinxupquote{ASDF\_filename}}
\begin{itemize}
\item {} 
The name of the output ASDF file

\end{itemize}


\subsubsection{Example}
\label{\detokenize{tutorials/S2_Syn_Waveform:example}}\begin{itemize}
\item {} 
The \sphinxstylestrong{example\_path} need to de changed to your path, and run this notebook to set \sphinxstylestrong{syn.json} file.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}*\PYGZhy{} coding: utf\PYGZhy{}8 \PYGZhy{}*\PYGZhy{}}

\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{sys}
\PYG{k+kn}{import} \PYG{n+nn}{json5}
\PYG{k+kn}{import} \PYG{n+nn}{shutil}

\PYG{c+c1}{\PYGZsh{} The root directory of the project}
\PYG{n}{example\PYGZus{}path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/Users/yf/3.Project/8.MCMTpy/MCMTpy\PYGZhy{}master/data/example\PYGZus{}yunnan}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} we expect no parameters need to be changed below}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} change path to Green\PYGZus{}Funcs}
\PYG{n}{notebook\PYGZus{}path} \PYG{o}{=} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{path}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{n}{notebook\PYGZus{}path}\PYG{p}{)}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../syn}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{os}\PYG{o}{.}\PYG{n}{listdir}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} show build\PYGZus{}GFs.json }
\PYG{n}{filename} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{syn.json}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{filename}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{encoding}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{utf\PYGZhy{}8}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f1}\PYG{p}{:}
    \PYG{n}{syn\PYGZus{}json}\PYG{o}{=}\PYG{n}{json5}\PYG{o}{.}\PYG{n}{load}\PYG{p}{(}\PYG{n}{f1}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} change parameters with absolute path}
\PYG{n}{syn\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GFs\PYGZus{}json\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Green\PYGZus{}Funcs/build\PYGZus{}GFs\PYGZus{}new.json}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{syn\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Stf\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{syn/Stf\PYGZus{}file/Stf\PYGZus{}file.sac}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{syn\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Output\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{syn/Synthetic}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}       
\PYG{n}{syn\PYGZus{}json\PYGZus{}new} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{syn/syn\PYGZus{}new.json}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{syn\PYGZus{}json\PYGZus{}new}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f2}\PYG{p}{:}
    \PYG{n}{json5}\PYG{o}{.}\PYG{n}{dump}\PYG{p}{(}\PYG{n}{syn\PYGZus{}json}\PYG{p}{,} \PYG{n}{f2}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{f2}\PYG{o}{.}\PYG{n}{close}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{shutil}\PYG{o}{.}\PYG{n}{rmtree}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{./Synthetic}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} !MCMTpy syn pyfk  \PYGZhy{}c ./syn\PYGZus{}new.json  \PYGZgt{} syn.log}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
Now you can run MCMTpy in bash:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} MCMTpy  syn pyfk  \PYGZhy{}c ./syn.json
\end{sphinxVerbatim}

\item {} 
View syn waveform:

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}*\PYGZhy{} coding: utf\PYGZhy{}8 \PYGZhy{}*\PYGZhy{}}

\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{pyasdf}


\PYG{c+c1}{\PYGZsh{} The root directory of the project}
\PYG{n}{example\PYGZus{}path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/Users/yf/3.Project/8.MCMTpy/MCMTpy\PYGZhy{}master/data/example\PYGZus{}yunnan}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} we expect no parameters need to be changed below}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} change the path}
\PYG{n}{h5\PYGZus{}path} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{syn/Synthetic/SYN\PYGZus{}test.h5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{source\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{source\PYGZus{}syn}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{}\PYGZsh{} read h5 data \PYGZhy{}\PYGZhy{}\PYGZgt{} Sta\PYGZus{}data (dict)}
\PYG{n}{ds\PYGZus{}raw}\PYG{o}{=}\PYG{n}{pyasdf}\PYG{o}{.}\PYG{n}{ASDFDataSet}\PYG{p}{(}\PYG{n}{h5\PYGZus{}path}\PYG{p}{,}\PYG{n}{mpi}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,}\PYG{n}{mode}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{Station\PYGZus{}list} \PYG{o}{=} \PYG{n}{ds\PYGZus{}raw}\PYG{o}{.}\PYG{n}{waveforms}\PYG{o}{.}\PYG{n}{list}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{Station\PYGZus{}num} \PYG{o}{=} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{Station\PYGZus{}list}\PYG{p}{)}

\PYG{n}{Sta\PYGZus{}data}\PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{Station\PYGZus{}num}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{info}\PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
    \PYG{n}{tags} \PYG{o}{=} \PYG{n}{ds\PYGZus{}raw}\PYG{o}{.}\PYG{n}{waveforms}\PYG{p}{[}\PYG{n}{Station\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{]}\PYG{o}{.}\PYG{n}{get\PYGZus{}waveform\PYGZus{}tags}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{source\PYGZus{}name} \PYG{o+ow}{in} \PYG{n}{tags}\PYG{p}{:}
        \PYG{n}{raw\PYGZus{}sac} \PYG{o}{=} \PYG{n}{ds\PYGZus{}raw}\PYG{o}{.}\PYG{n}{waveforms}\PYG{p}{[}\PYG{n}{Station\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{n}{source\PYGZus{}name}\PYG{p}{]}
        \PYG{n}{tp} \PYG{o}{=} \PYG{n+nb}{float}\PYG{p}{(} \PYG{n}{ds\PYGZus{}raw}\PYG{o}{.}\PYG{n}{waveforms}\PYG{p}{[}\PYG{n}{Station\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{n}{source\PYGZus{}name}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{asdf}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{labels}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{p}{)}
        \PYG{n}{ts} \PYG{o}{=} \PYG{n+nb}{float}\PYG{p}{(} \PYG{n}{ds\PYGZus{}raw}\PYG{o}{.}\PYG{n}{waveforms}\PYG{p}{[}\PYG{n}{Station\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{]}\PYG{p}{[}\PYG{n}{source\PYGZus{}name}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{asdf}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{labels}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]} \PYG{p}{)}
        \PYG{n}{info}\PYG{o}{.}\PYG{n}{update}\PYG{p}{(}\PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{tp}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{tp}\PYG{p}{\PYGZcb{}}\PYG{p}{)}  
        \PYG{n}{info}\PYG{o}{.}\PYG{n}{update}\PYG{p}{(}\PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ts}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{ts}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
        \PYG{n}{info}\PYG{o}{.}\PYG{n}{update}\PYG{p}{(}\PYG{p}{\PYGZob{}} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{data}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{raw\PYGZus{}sac}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
        \PYG{n}{Sta\PYGZus{}data}\PYG{o}{.}\PYG{n}{update}\PYG{p}{(}\PYG{p}{\PYGZob{}} \PYG{n}{Station\PYGZus{}list}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{:} \PYG{n}{info}\PYG{p}{\PYGZcb{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} plot data}
\PYG{n}{ax} \PYG{o}{=} \PYG{n}{Sta\PYGZus{}data}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YN.YUM}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{Sta\PYGZus{}data}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YN.YUM}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}
Please follow the above parameter instructions and set all parameters correctly before running the program.
Otherwise, it is easy to report an error!
\end{sphinxadmonition}


\subsection{Prepare Data for MCMTpy}
\label{\detokenize{tutorials/S3_Process_Data:prepare-data-for-mcmtpy}}\label{\detokenize{tutorials/S3_Process_Data::doc}}
\begin{sphinxShadowBox}
\begin{itemize}
\item {} 
\phantomsection\label{\detokenize{tutorials/S3_Process_Data:id1}}{\hyperref[\detokenize{tutorials/S3_Process_Data:format-of-mcmtpy-input-data}]{\sphinxcrossref{Format of MCMTpy input data:}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S3_Process_Data:id2}}{\hyperref[\detokenize{tutorials/S3_Process_Data:example}]{\sphinxcrossref{Example}}}

\end{itemize}
\end{sphinxShadowBox}


\subsubsection{Format of MCMTpy input data:}
\label{\detokenize{tutorials/S3_Process_Data:format-of-mcmtpy-input-data}}\begin{itemize}
\item {} 
\sphinxstylestrong{ASDF} file format, and the sampling rate \sphinxcode{\sphinxupquote{dt}} is consistent with that of GFs database.

\item {} 
Must be \sphinxstylestrong{ENZ} three\sphinxhyphen{}component data and the name of the channel must be ‘E’/’N’/’Z’ order.

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
Pyasdf files are automatically sorted by name. So you must make sure that the order of the Trace
is still ENZ after the automatic sorting, generally the name of the channel  ‘BHE’/’BHN’/’BHZ’ will be fine.
\end{sphinxadmonition}
\begin{itemize}
\item {} 
\sphinxstylestrong{Trace.Stats.sac.t1}/\sphinxstylestrong{Trace.Stats.sac.t2} must be included in the trace header file to represent the P/S phase time.

\item {} 
The trace header file must include the \sphinxstylestrong{station} and \sphinxstylestrong{network} name.

\item {} 
The trace header file must include \sphinxstylestrong{b/e/o/stla/stlo/stdp/evlo/evla/evdp/mag/dist/az/baz}, time information,
event longitude and latitude information, azimuth information.

\item {} 
The trace header file must include \sphinxstylestrong{starttime/endtime}.

\item {} 
All traces need to retain a uniform number of sampling points before T1, such as \sphinxstylestrong{p\_n0 = 50}.

\end{itemize}


\subsubsection{Example}
\label{\detokenize{tutorials/S3_Process_Data:example}}\begin{itemize}
\item {} 
We have provided some useful scripts for data preprocessing, and the \sphinxstylestrong{example\_path} need to de changed to your path,
and run this notebook.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}*\PYGZhy{} coding: utf\PYGZhy{}8 \PYGZhy{}*\PYGZhy{}}

\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{glob}
\PYG{k+kn}{import} \PYG{n+nn}{obspy}
\PYG{k+kn}{import} \PYG{n+nn}{shutil}
\PYG{k+kn}{from} \PYG{n+nn}{obspy} \PYG{k+kn}{import} \PYG{n}{Stream}
\PYG{k+kn}{from} \PYG{n+nn}{obspy}\PYG{n+nn}{.}\PYG{n+nn}{taup} \PYG{k+kn}{import} \PYG{n}{TauPyModel}
\PYG{k+kn}{from} \PYG{n+nn}{MCMTpy}\PYG{n+nn}{.}\PYG{n+nn}{utils}\PYG{n+nn}{.}\PYG{n+nn}{asdf\PYGZus{}function} \PYG{k+kn}{import} \PYG{n}{Add\PYGZus{}waveforms}\PYG{p}{,}\PYG{n}{Add\PYGZus{}stationxml}\PYG{p}{,}\PYG{n}{get\PYGZus{}QuakeML}\PYG{p}{,}\PYG{n}{Add\PYGZus{}quakeml}
\PYG{k+kn}{from} \PYG{n+nn}{MCMTpy}\PYG{n+nn}{.}\PYG{n+nn}{utils}\PYG{n+nn}{.}\PYG{n+nn}{asdf\PYGZus{}function} \PYG{k+kn}{import} \PYG{n}{get\PYGZus{}StationXML}

\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} 1.read raw data}
\PYG{k}{def} \PYG{n+nf}{read\PYGZus{}data}\PYG{p}{(}\PYG{n}{allfiles\PYGZus{}path}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{allfiles} \PYG{o}{=} \PYG{n+nb}{sorted}\PYG{p}{(} \PYG{n}{glob}\PYG{o}{.}\PYG{n}{glob}\PYG{p}{(}\PYG{n}{allfiles\PYGZus{}path}\PYG{p}{)} \PYG{p}{)}
    \PYG{n}{data\PYGZus{}raw} \PYG{o}{=} \PYG{n}{Stream}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{allfiles}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{tr} \PYG{o}{=} \PYG{n}{obspy}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{n}{allfiles}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
            \PYG{n}{data\PYGZus{}raw} \PYG{o}{+}\PYG{o}{=} \PYG{n}{tr}
        \PYG{k}{except} \PYG{n+ne}{Exception}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{allfiles}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{: no such file or obspy read error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}\PYG{k}{continue}
    \PYG{n}{data} \PYG{o}{=} \PYG{n}{data\PYGZus{}raw}\PYG{o}{.}\PYG{n}{copy}\PYG{p}{(}\PYG{p}{)}
    
    \PYG{k}{return} \PYG{n}{data}

\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} 2.get\PYGZus{}taup\PYGZus{}tp\PYGZus{}ts}
\PYG{k}{def} \PYG{n+nf}{get\PYGZus{}taup\PYGZus{}tp\PYGZus{}ts}\PYG{p}{(}\PYG{n}{model}\PYG{p}{,}\PYG{n}{depth}\PYG{p}{,}\PYG{n}{distance}\PYG{p}{,}\PYG{n}{degree}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{if} \PYG{n}{degree}\PYG{o}{==}\PYG{k+kc}{False}\PYG{p}{:}
        \PYG{n}{distance} \PYG{o}{=} \PYG{n}{distance}\PYG{o}{/}\PYG{l+m+mf}{111.19}

    \PYG{n}{time\PYGZus{}p} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{get\PYGZus{}travel\PYGZus{}times}\PYG{p}{(}\PYG{n}{source\PYGZus{}depth\PYGZus{}in\PYGZus{}km}\PYG{o}{=}\PYG{n}{depth}\PYG{p}{,}
                                    \PYG{n}{distance\PYGZus{}in\PYGZus{}degree}\PYG{o}{=}\PYG{n}{distance}\PYG{p}{,}
                                    \PYG{n}{phase\PYGZus{}list}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{p}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{P}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}

    \PYG{n}{time\PYGZus{}s} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{get\PYGZus{}travel\PYGZus{}times}\PYG{p}{(}\PYG{n}{source\PYGZus{}depth\PYGZus{}in\PYGZus{}km}\PYG{o}{=}\PYG{n}{depth}\PYG{p}{,}
                                    \PYG{n}{distance\PYGZus{}in\PYGZus{}degree}\PYG{o}{=}\PYG{n}{distance}\PYG{p}{,}
                                    \PYG{n}{phase\PYGZus{}list}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{s}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{S}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}

    \PYG{n}{ray\PYGZus{}p} \PYG{o}{=} \PYG{n}{time\PYGZus{}p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{ray\PYGZus{}param}
    \PYG{n}{tp} \PYG{o}{=} \PYG{n}{time\PYGZus{}p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{time}
    \PYG{n}{angle\PYGZus{}p} \PYG{o}{=} \PYG{n}{time\PYGZus{}p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{incident\PYGZus{}angle}

    \PYG{n}{ray\PYGZus{}s} \PYG{o}{=} \PYG{n}{time\PYGZus{}s}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{ray\PYGZus{}param}
    \PYG{n}{ts} \PYG{o}{=} \PYG{n}{time\PYGZus{}s}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{time}
    \PYG{n}{angle\PYGZus{}s} \PYG{o}{=} \PYG{n}{time\PYGZus{}s}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{incident\PYGZus{}angle}

    \PYG{k}{return} \PYG{n}{ray\PYGZus{}p}\PYG{p}{,}\PYG{n}{tp}\PYG{p}{,}\PYG{n}{angle\PYGZus{}p}\PYG{p}{,}\PYG{n}{ray\PYGZus{}s}\PYG{p}{,}\PYG{n}{ts}\PYG{p}{,}\PYG{n}{angle\PYGZus{}s}

\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} 3.preprocess}
\PYG{k}{def} \PYG{n+nf}{preprocess}\PYG{p}{(}\PYG{n}{data}\PYG{p}{,}\PYG{n}{freqmin}\PYG{p}{,}\PYG{n}{freqmax}\PYG{p}{,}\PYG{n}{samp\PYGZus{}freq}\PYG{p}{,}\PYG{n}{p\PYGZus{}n0}\PYG{p}{,}\PYG{n}{npts}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{data}\PYG{o}{.}\PYG{n}{detrend}\PYG{p}{(}\PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{demean}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{data}\PYG{o}{.}\PYG{n}{detrend}\PYG{p}{(}\PYG{n+nb}{type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{simple}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{data}\PYG{o}{.}\PYG{n}{taper}\PYG{p}{(}\PYG{n}{max\PYGZus{}percentage}\PYG{o}{=}\PYG{l+m+mf}{0.05}\PYG{p}{)}

    \PYG{n}{data}\PYG{o}{.}\PYG{n}{filter}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bandpass}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{freqmin}\PYG{o}{=}\PYG{n}{freqmin}\PYG{p}{,} \PYG{n}{freqmax}\PYG{o}{=}\PYG{n}{freqmax}\PYG{p}{,} \PYG{n}{corners}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{zerophase}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} bandpass}
    \PYG{n}{data}\PYG{o}{.}\PYG{n}{resample}\PYG{p}{(}\PYG{n}{samp\PYGZus{}freq}\PYG{p}{,}\PYG{n}{window}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hanning}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{no\PYGZus{}filter}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{strict\PYGZus{}length}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}         \PYG{c+c1}{\PYGZsh{} resample}

    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{b} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
        \PYG{n}{t1} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
        \PYG{n}{t\PYGZus{}start} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{starttime} \PYG{o}{+} \PYG{p}{(}\PYG{n}{t1}\PYG{o}{\PYGZhy{}}\PYG{n}{b}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{p\PYGZus{}n0}\PYG{o}{/}\PYG{n}{samp\PYGZus{}freq}
        \PYG{n}{t\PYGZus{}end\PYGZus{}npts} \PYG{o}{=} \PYG{n}{t\PYGZus{}start}\PYG{o}{+}\PYG{n}{npts}\PYG{o}{/}\PYG{n}{samp\PYGZus{}freq}
        \PYG{n}{t\PYGZus{}endtime} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{endtime}
        \PYG{k}{if} \PYG{n}{t\PYGZus{}end\PYGZus{}npts} \PYG{o}{\PYGZgt{}} \PYG{n}{t\PYGZus{}endtime}\PYG{p}{:}
            \PYG{n}{t\PYGZus{}end} \PYG{o}{=} \PYG{n}{t\PYGZus{}endtime}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{t\PYGZus{}end} \PYG{o}{=} \PYG{n}{t\PYGZus{}end\PYGZus{}npts}

        \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{trim}\PYG{p}{(}\PYG{n}{t\PYGZus{}start}\PYG{p}{,} \PYG{n}{t\PYGZus{}end}\PYG{p}{)}

    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n+nb}{round}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{t\PYGZus{}start\PYGZus{}1} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{starttime}
        \PYG{n}{t\PYGZus{}start\PYGZus{}2} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{starttime}
        \PYG{n}{t\PYGZus{}start\PYGZus{}3} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{starttime}
        \PYG{n}{t\PYGZus{}end\PYGZus{}1} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{endtime}
        \PYG{n}{t\PYGZus{}end\PYGZus{}2} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{endtime}
        \PYG{n}{t\PYGZus{}end\PYGZus{}3} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{endtime}
        \PYG{n}{t\PYGZus{}start} \PYG{o}{=} \PYG{n+nb}{max}\PYG{p}{(}\PYG{n}{t\PYGZus{}start\PYGZus{}1}\PYG{p}{,}\PYG{n}{t\PYGZus{}start\PYGZus{}2}\PYG{p}{,}\PYG{n}{t\PYGZus{}start\PYGZus{}3}\PYG{p}{)}
        \PYG{n}{t\PYGZus{}end} \PYG{o}{=} \PYG{n+nb}{min}\PYG{p}{(}\PYG{n}{t\PYGZus{}end\PYGZus{}1}\PYG{p}{,}\PYG{n}{t\PYGZus{}end\PYGZus{}2}\PYG{p}{,}\PYG{n}{t\PYGZus{}end\PYGZus{}3}\PYG{p}{)}
        \PYG{n}{data}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{o}{.}\PYG{n}{trim}\PYG{p}{(}\PYG{n}{t\PYGZus{}start}\PYG{p}{,} \PYG{n}{t\PYGZus{}end}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} velocity(nm/s) to velocity(cm/s)}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{data} \PYG{o}{=} \PYG{l+m+mf}{1e\PYGZhy{}6}\PYG{o}{*}\PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{data}

\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} 4.write\PYGZus{}ASDF}
\PYG{k}{def} \PYG{n+nf}{write\PYGZus{}ASDF}\PYG{p}{(}\PYG{n}{data\PYGZus{}enz}\PYG{p}{,}\PYG{n}{Output\PYGZus{}path}\PYG{p}{,}\PYG{n}{source\PYGZus{}name}\PYG{p}{,}\PYG{n}{ASDF\PYGZus{}filename}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{source\PYGZus{}lat}   \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{o}{.}\PYG{n}{evla}
    \PYG{n}{source\PYGZus{}lon}   \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{o}{.}\PYG{n}{evlo}
    \PYG{n}{source\PYGZus{}depth} \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{o}{.}\PYG{n}{evdp}
    \PYG{n}{source\PYGZus{}time}  \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{starttime} \PYG{o}{+} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{o}{.}\PYG{n}{b}

    \PYG{n}{Output\PYGZus{}file\PYGZus{}path} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{Output\PYGZus{}path}\PYG{p}{,} \PYG{n}{ASDF\PYGZus{}filename}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.h5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{catalog\PYGZus{}create}   \PYG{o}{=} \PYG{n}{get\PYGZus{}QuakeML}\PYG{p}{(}\PYG{n}{source\PYGZus{}name}\PYG{p}{,} \PYG{n}{source\PYGZus{}lat}\PYG{p}{,} \PYG{n}{source\PYGZus{}lon}\PYG{p}{,} \PYG{n}{source\PYGZus{}depth}\PYG{p}{,}\PYG{n}{source\PYGZus{}time}\PYG{p}{)}
    \PYG{n}{Add\PYGZus{}quakeml}\PYG{p}{(}\PYG{n}{Output\PYGZus{}file\PYGZus{}path}\PYG{p}{,}\PYG{n}{catalog\PYGZus{}create}\PYG{p}{)}

    \PYG{n}{Station\PYGZus{}num} \PYG{o}{=} \PYG{n+nb}{round}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{data\PYGZus{}enz}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{Station\PYGZus{}num}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:} 
        \PYG{n}{net\PYGZus{}sta\PYGZus{}name}     \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{network}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{data}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{station}
        \PYG{n}{station\PYGZus{}network}  \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{network}
        \PYG{n}{station\PYGZus{}name}     \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{station}
        \PYG{n}{station\PYGZus{}lat}      \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{o}{.}\PYG{n}{stla}
        \PYG{n}{station\PYGZus{}lon}      \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{o}{.}\PYG{n}{stlo}
        \PYG{n}{station\PYGZus{}depth}    \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{station\PYGZus{}distance} \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{o}{.}\PYG{n}{dist}
        \PYG{n}{station\PYGZus{}az}       \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{o}{.}\PYG{n}{az}
        \PYG{n}{station\PYGZus{}baz}      \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{o}{.}\PYG{n}{baz}
        \PYG{n}{tp}               \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{o}{.}\PYG{n}{t1}
        \PYG{n}{ts}               \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{o}{.}\PYG{n}{t2}
        \PYG{n}{stream}           \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{o}{.}\PYG{n}{copy}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{starttime}        \PYG{o}{=} \PYG{n}{data\PYGZus{}enz}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{starttime}
        \PYG{n}{time\PYGZus{}before\PYGZus{}first\PYGZus{}arrival} \PYG{o}{=} \PYG{n}{p\PYGZus{}n0}\PYG{o}{/}\PYG{n}{samp\PYGZus{}freq}

        \PYG{n}{inv}\PYG{o}{=}\PYG{n}{get\PYGZus{}StationXML}\PYG{p}{(}\PYG{n}{station\PYGZus{}network}\PYG{p}{,} 
                           \PYG{n}{station\PYGZus{}name}\PYG{p}{,}
                           \PYG{n}{station\PYGZus{}lat}\PYG{p}{,} 
                           \PYG{n}{station\PYGZus{}lon}\PYG{p}{,} 
                           \PYG{n}{station\PYGZus{}depth}\PYG{p}{,} 
                           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{enz}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

        \PYG{n}{Add\PYGZus{}waveforms}\PYG{p}{(}\PYG{p}{[}\PYG{n}{stream}\PYG{p}{]}\PYG{p}{,} 
                      \PYG{n}{catalog\PYGZus{}create}\PYG{p}{,}
                      \PYG{n}{Output\PYGZus{}file\PYGZus{}path}\PYG{p}{,}
                      \PYG{n}{source\PYGZus{}name}\PYG{p}{,}
                      \PYG{n}{tp}\PYG{p}{,}
                      \PYG{n}{ts}\PYG{p}{,}
                      \PYG{n}{station\PYGZus{}distance}\PYG{p}{,}
                      \PYG{n}{station\PYGZus{}az}\PYG{p}{,}
                      \PYG{n}{station\PYGZus{}baz}\PYG{p}{)} 

        \PYG{n}{Add\PYGZus{}stationxml}\PYG{p}{(}\PYG{n}{inv}\PYG{p}{,}
                       \PYG{n}{Output\PYGZus{}file\PYGZus{}path}\PYG{p}{)} 

        \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:} 
            \PYG{n}{CHN} \PYG{o}{=} \PYG{n}{stream}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{channel}
            \PYG{n}{sac\PYGZus{}filename} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{Output\PYGZus{}path}\PYG{p}{,}\PYG{n}{source\PYGZus{}name}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{station\PYGZus{}network}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{station\PYGZus{}name}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{CHN}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.sac}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
            \PYG{n}{stream}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{n}{sac\PYGZus{}filename}\PYG{p}{,} \PYG{n+nb}{format}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SAC}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}




\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} 0. main}
\PYG{c+c1}{\PYGZsh{} The root directory of the project}
\PYG{n}{example\PYGZus{}path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/Users/yf/3.Project/8.MCMTpy/MCMTpy\PYGZhy{}master/data/example\PYGZus{}yunnan}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{freqmin}       \PYG{o}{=} \PYG{l+m+mf}{0.005}                               \PYG{c+c1}{\PYGZsh{} pre filtering frequency bandwidth (hz)}
\PYG{n}{freqmax}       \PYG{o}{=} \PYG{l+m+mi}{2}                                   \PYG{c+c1}{\PYGZsh{} note this cannot exceed Nquist frequency (hz)}
\PYG{n}{samp\PYGZus{}freq}     \PYG{o}{=} \PYG{l+m+mi}{5}                                   \PYG{c+c1}{\PYGZsh{} targeted sampling rate (hz)}
\PYG{n}{p\PYGZus{}n0}          \PYG{o}{=} \PYG{l+m+mi}{50}                                  \PYG{c+c1}{\PYGZsh{} number of sampling points before P wave arrives}
\PYG{n}{npts}          \PYG{o}{=} \PYG{l+m+mi}{2048}                                \PYG{c+c1}{\PYGZsh{} data length}
\PYG{n}{Output\PYGZus{}path}   \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{YN.202105212148\PYGZus{}Inv/YN.202105212148\PYGZus{}MCMTpy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{source\PYGZus{}name}   \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{source\PYGZus{}enz}\PYG{l+s+s2}{\PYGZdq{}}                        \PYG{c+c1}{\PYGZsh{} asdf‘s source\PYGZus{}tag}
\PYG{n}{ASDF\PYGZus{}filename} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{YN.202105212148}\PYG{l+s+s2}{\PYGZdq{}}                   \PYG{c+c1}{\PYGZsh{} asdf filename}





\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} we expect no parameters need to be changed below}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} 1. read raw data}
\PYG{n}{allfiles\PYGZus{}path} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YN.202105212148\PYGZus{}Inv/YN.202105212148\PYGZus{}raw/*.SAC}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}  
\PYG{n}{data} \PYG{o}{=} \PYG{n}{read\PYGZus{}data}\PYG{p}{(}\PYG{n}{allfiles\PYGZus{}path}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 2. taup ray tracing}
\PYG{n}{model\PYGZus{}path} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{v\PYGZus{}model/v\PYGZus{}model.npz}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{model} \PYG{o}{=} \PYG{n}{TauPyModel}\PYG{p}{(}\PYG{n}{model}\PYG{o}{=}\PYG{n}{model\PYGZus{}path}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{depth} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{evdp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
    \PYG{n}{distance} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dist}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
    \PYG{n}{ray\PYGZus{}p}\PYG{p}{,}\PYG{n}{tp}\PYG{p}{,}\PYG{n}{angle\PYGZus{}p}\PYG{p}{,}\PYG{n}{ray\PYGZus{}s}\PYG{p}{,}\PYG{n}{ts}\PYG{p}{,}\PYG{n}{angle\PYGZus{}s} \PYG{o}{=} \PYG{n}{get\PYGZus{}taup\PYGZus{}tp\PYGZus{}ts}\PYG{p}{(}\PYG{n}{model}\PYG{p}{,}\PYG{n}{depth}\PYG{p}{,}\PYG{n}{distance}\PYG{p}{,}\PYG{n}{degree}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
    \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{t1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{o}{=}\PYG{n}{tp}
    \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{t2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{o}{=}\PYG{n}{ts}

\PYG{c+c1}{\PYGZsh{} 3. preprocess}
\PYG{n}{preprocess}\PYG{p}{(}\PYG{n}{data}\PYG{p}{,}\PYG{n}{freqmin}\PYG{p}{,}\PYG{n}{freqmax}\PYG{p}{,}\PYG{n}{samp\PYGZus{}freq}\PYG{p}{,}\PYG{n}{p\PYGZus{}n0}\PYG{p}{,}\PYG{n}{npts}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 4. output ASDF and SAC data}
\PYG{n}{shutil}\PYG{o}{.}\PYG{n}{rmtree}\PYG{p}{(}\PYG{n}{Output\PYGZus{}path}\PYG{p}{)}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{mkdir}\PYG{p}{(}\PYG{n}{Output\PYGZus{}path}\PYG{p}{)}
\PYG{n}{write\PYGZus{}ASDF}\PYG{p}{(}\PYG{n}{data}\PYG{p}{,}\PYG{n}{Output\PYGZus{}path}\PYG{p}{,}\PYG{n}{source\PYGZus{}name}\PYG{p}{,}\PYG{n}{ASDF\PYGZus{}filename}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}
Please follow the above parameter instructions and set all parameters correctly before running the program.
Otherwise, it is easy to report an error!
\end{sphinxadmonition}


\subsection{Inversion of  Source}
\label{\detokenize{tutorials/S4_Inv_DC:inversion-of-source}}\label{\detokenize{tutorials/S4_Inv_DC::doc}}
\begin{sphinxShadowBox}
\begin{itemize}
\item {} 
\phantomsection\label{\detokenize{tutorials/S4_Inv_DC:id1}}{\hyperref[\detokenize{tutorials/S4_Inv_DC:path}]{\sphinxcrossref{Path}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S4_Inv_DC:id2}}{\hyperref[\detokenize{tutorials/S4_Inv_DC:source-time-function}]{\sphinxcrossref{Source Time Function}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S4_Inv_DC:id3}}{\hyperref[\detokenize{tutorials/S4_Inv_DC:mpi-and-chains-n}]{\sphinxcrossref{MPI and Chains\_n}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S4_Inv_DC:id4}}{\hyperref[\detokenize{tutorials/S4_Inv_DC:misfit}]{\sphinxcrossref{Misfit}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S4_Inv_DC:id5}}{\hyperref[\detokenize{tutorials/S4_Inv_DC:inversion-parameters}]{\sphinxcrossref{Inversion parameters}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S4_Inv_DC:id6}}{\hyperref[\detokenize{tutorials/S4_Inv_DC:alpha}]{\sphinxcrossref{Alpha}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S4_Inv_DC:id7}}{\hyperref[\detokenize{tutorials/S4_Inv_DC:logging-file}]{\sphinxcrossref{Logging file}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S4_Inv_DC:id8}}{\hyperref[\detokenize{tutorials/S4_Inv_DC:example-double-couple-inv}]{\sphinxcrossref{Example Double\sphinxhyphen{}Couple Inv}}}

\end{itemize}
\end{sphinxShadowBox}
\begin{itemize}
\item {} 
This is the core of the MCMTpy, and all parameters are written into a JSON file named \sphinxstylestrong{sample\_dc.json}.
Some brief descriptions of the parameters are included here following the definination.

\item {} 
We do not recommend using relative paths because of the possibility of errors. \sphinxstylestrong{Absolute paths} are preferred.

\end{itemize}


\subsubsection{Path}
\label{\detokenize{tutorials/S4_Inv_DC:path}}
\sphinxcode{\sphinxupquote{GFs\_json\_file}}
\begin{itemize}
\item {} 
The path to the Json\sphinxhyphen{}file used to calculate Green Function Database.

\end{itemize}

\sphinxcode{\sphinxupquote{GFs\_file}}
\begin{itemize}
\item {} 
The path to the Green Function Database.

\end{itemize}

\sphinxcode{\sphinxupquote{Raw\_data\_file}}
\begin{itemize}
\item {} 
The path to the Raw data ASDF file.

\end{itemize}

\sphinxcode{\sphinxupquote{Source\_tag}}
\begin{itemize}
\item {} 
Raw data ASDF file’s source name which setted in the data preprocess function.

\end{itemize}

\sphinxcode{\sphinxupquote{Raw\_p\_n0}}
\begin{itemize}
\item {} 
The number of points before the first arrival. Be consistent with the GFs’ \sphinxcode{\sphinxupquote{samples\_before\_first\_arrival}}.

\end{itemize}

\sphinxcode{\sphinxupquote{Dt}}
\begin{itemize}
\item {} 
Sampling rate of the raw data.

\end{itemize}

\sphinxcode{\sphinxupquote{Output\_path}}
\begin{itemize}
\item {} 
Inversion result output file path.

\end{itemize}


\subsubsection{Source Time Function}
\label{\detokenize{tutorials/S4_Inv_DC:source-time-function}}
\sphinxcode{\sphinxupquote{Trapezoid\_stf\_mode}}
\begin{itemize}
\item {} 
Whether to use pyfk provided trapezoid shaped source time function. Set to be \sphinxstylestrong{.true.} you need to set the following parameters correctly:

\sphinxcode{\sphinxupquote{dura}}
\sphinxcode{\sphinxupquote{rise}}
\sphinxcode{\sphinxupquote{delta}}

\end{itemize}

\sphinxcode{\sphinxupquote{dura}}
\begin{itemize}
\item {} 
Duration time (s).

\end{itemize}

\sphinxcode{\sphinxupquote{rise}}
\begin{itemize}
\item {} 
Rise time (s).

\end{itemize}

\sphinxcode{\sphinxupquote{delta}}
\begin{itemize}
\item {} 
The time interval (s).

\end{itemize}

\sphinxcode{\sphinxupquote{Stf\_file}}
\begin{itemize}
\item {} 
Stf\_file should be an \sphinxstylestrong{SAC} file as the source time function when set \sphinxcode{\sphinxupquote{Trapezoid\_stf\_mode}} to be \sphinxstylestrong{.false.}.

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
To read the data from the \sphinxcode{\sphinxupquote{Stf\_file}} file, keep the sampling rate of SAC data consistent with the data and GFs.
\end{sphinxadmonition}


\subsubsection{MPI and Chains\_n}
\label{\detokenize{tutorials/S4_Inv_DC:mpi-and-chains-n}}
\sphinxcode{\sphinxupquote{MPI\_n}}
\begin{itemize}
\item {} 
CPU number

\end{itemize}

\sphinxcode{\sphinxupquote{Chains\_n}}
\begin{itemize}
\item {} 
A total of n Markov Chains are sampled on each core (CPU).

\end{itemize}

\sphinxcode{\sphinxupquote{N}}
\begin{itemize}
\item {} 
Each Markov Chains’ sampling number.

\end{itemize}


\subsubsection{Misfit}
\label{\detokenize{tutorials/S4_Inv_DC:misfit}}
\sphinxcode{\sphinxupquote{Geometrical\_spreading\_mode}}
\begin{itemize}
\item {} 
Whether the geometric diffusion correction is turned on or not. Waveform normalization is used when
it set to be \sphinxstylestrong{.false.}, and please set the magnitude \sphinxstylestrong{M0} not to be inverted in \sphinxcode{\sphinxupquote{Fixed\_FM}}.
Only one of \sphinxcode{\sphinxupquote{Geometrical\_spreading\_mode}} and \sphinxcode{\sphinxupquote{Amplitude\_normalization\_mode}} can be \sphinxstylestrong{.true.}.

\end{itemize}

\sphinxcode{\sphinxupquote{Distance\_0}}
\begin{itemize}
\item {} 
The reference epicentral distance when \sphinxcode{\sphinxupquote{Geometrical\_spreading\_mode}} set to be \sphinxstylestrong{.true.}.

\end{itemize}

\sphinxcode{\sphinxupquote{Amplitude\_normalization\_mode}}
\begin{itemize}
\item {} 
Waveform normalization mode.Only one of \sphinxcode{\sphinxupquote{Geometrical\_spreading\_mode}} and
\sphinxcode{\sphinxupquote{Amplitude\_normalization\_mode}} can be \sphinxstylestrong{.true.}.

\end{itemize}

\sphinxcode{\sphinxupquote{Use\_file\_mode}}
\begin{itemize}
\item {} 
When set it to be \sphinxstylestrong{.false.}, don’t need to provide \sphinxcode{\sphinxupquote{Raw\_data\_inv\_info}} file. Setting following parameters
(\sphinxcode{\sphinxupquote{Raw\_data\_inv\_info\_writed}},
\sphinxcode{\sphinxupquote{NET\_STA}},
\sphinxcode{\sphinxupquote{P\_inv\_comp}},
\sphinxcode{\sphinxupquote{S\_inv\_comp}},
\sphinxcode{\sphinxupquote{Surf\_inv\_comp}},
\sphinxcode{\sphinxupquote{P\_win}},
\sphinxcode{\sphinxupquote{S\_win}},
\sphinxcode{\sphinxupquote{Surf\_win}},
\sphinxcode{\sphinxupquote{Phase\_weight}},
\sphinxcode{\sphinxupquote{Distance\_weight}},
\sphinxcode{\sphinxupquote{P\_maxlag}},
\sphinxcode{\sphinxupquote{S\_maxlag}},
\sphinxcode{\sphinxupquote{Surf\_maxlag}},
\sphinxcode{\sphinxupquote{P\_filter}},
\sphinxcode{\sphinxupquote{S\_filter}},
\sphinxcode{\sphinxupquote{Surf\_filter}})
correctly, \sphinxcode{\sphinxupquote{MCMTpy}} will generate this file automatically, so you can change individual parameter values
and use this file for inversion. \sphinxcode{\sphinxupquote{Raw\_data\_inv\_info\_writed}} is the filename that generate this file automatically.
When set it to be \sphinxstylestrong{.true.}, \sphinxcode{\sphinxupquote{Raw\_data\_inv\_info}} is needed which is the path to inversion file.

\end{itemize}

\sphinxcode{\sphinxupquote{Raw\_data\_inv\_info}}
\begin{itemize}
\item {} 
The path to inversion parameters file. It includes the time window length, filtering range, weight
and other parameters used for data. When set \sphinxcode{\sphinxupquote{Use\_file\_mode}} to be \sphinxstylestrong{.true.}, it must be provided.

\item {} 
Raw\_data\_inv\_info.txt format.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
YN   EYA   
Lat\PYGZus{}lon\PYGZus{}depth	26.108801   99.947502   0.000000   
P\PYGZus{}inv\PYGZus{}comp	yes	yes	no	
S\PYGZus{}inv\PYGZus{}comp	no	no	no	
Surf\PYGZus{}inv\PYGZus{}comp	yes	yes	yes	
P\PYGZus{}win		\PYGZhy{}10.00	3.40	
S\PYGZus{}win		\PYGZhy{}5.00	25.20	
Surf\PYGZus{}win		\PYGZhy{}12.00	50.20	
Phase\PYGZus{}weight	1.0	1.0	1.0	
Distance\PYGZus{}weight	1.0	
P\PYGZus{}maxlag		5.0000	
S\PYGZus{}maxlag		15.0000	
Surf\PYGZus{}maxlag	10.0000	
P\PYGZus{}filter		0.010	0.20	
S\PYGZus{}filter		0.010	0.100	
Surf\PYGZus{}filter	0.005	0.100	

YN   YUL   
Lat\PYGZus{}lon\PYGZus{}depth	25.885401   99.371696   0.000000   
P\PYGZus{}inv\PYGZus{}comp	yes	yes	no	
S\PYGZus{}inv\PYGZus{}comp	no	no	no	
Surf\PYGZus{}inv\PYGZus{}comp	yes	yes	yes	
P\PYGZus{}win		\PYGZhy{}10.00	6.20	
S\PYGZus{}win		\PYGZhy{}5.00	25.20	
Surf\PYGZus{}win		\PYGZhy{}12.00	50.20	
Phase\PYGZus{}weight	1.0	1.0	1.0	
Distance\PYGZus{}weight	1.0	
P\PYGZus{}maxlag		5.0000	
S\PYGZus{}maxlag		15.0000	
Surf\PYGZus{}maxlag	10.0000	
P\PYGZus{}filter		0.010	0.200	
S\PYGZus{}filter		0.010	0.100	
Surf\PYGZus{}filter	0.005	0.100	
\end{sphinxVerbatim}

\sphinxcode{\sphinxupquote{Raw\_data\_inv\_info\_writed}}
\begin{itemize}
\item {} 
\sphinxcode{\sphinxupquote{Raw\_data\_inv\_info\_writed}} is the filename that generate this file automatically When set \sphinxcode{\sphinxupquote{Use\_file\_mode}}
to be \sphinxstylestrong{.true.}.

\end{itemize}

\sphinxcode{\sphinxupquote{NET\_STA}}
\begin{itemize}
\item {} 
The information contained in the two\sphinxhyphen{}dimensional list: {[}network\_name{]} {[}station\_name{]}  {[}station\_lat{]}   {[}source\_lon{]}    {[}station\_depth{]}

\end{itemize}

\sphinxcode{\sphinxupquote{P\_inv\_comp}}
\begin{itemize}
\item {} 
P wave Z/R/T component. ‘yes’: inversion. ‘no’: no inversion. Select the component you want to invert.

\end{itemize}

\sphinxcode{\sphinxupquote{S\_inv\_comp}}
\begin{itemize}
\item {} 
S wave Z/R/T component. ‘yes’: inversion. ‘no’: no inversion. Select the component you want to invert.

\end{itemize}

\sphinxcode{\sphinxupquote{Surf\_inv\_comp}}
\begin{itemize}
\item {} 
Surf wave Z/R/T component. ‘yes’: inversion. ‘no’: no inversion. Select the component you want to invert.

\end{itemize}

\sphinxcode{\sphinxupquote{P\_win}}
\begin{itemize}
\item {} 
P wave P\_win={[}\sphinxhyphen{}1,2{]} unit/s; The P wave fitting band, and ‘\sphinxhyphen{}1’ means 1 second before the P wave, ‘2’ means 2 second after the P wave

\end{itemize}

\sphinxcode{\sphinxupquote{S\_win}}
\begin{itemize}
\item {} 
S wave S\_win…

\end{itemize}

\sphinxcode{\sphinxupquote{Surf\_win}}
\begin{itemize}
\item {} 
Surf wave Surf\_win…

\end{itemize}

\sphinxcode{\sphinxupquote{Phase\_weight}}
\begin{itemize}
\item {} 
P/S/Surface wave inversion weight

\end{itemize}

\sphinxcode{\sphinxupquote{Distance\_weight}}
\begin{itemize}
\item {} 
The weight of each station in \sphinxcode{\sphinxupquote{NET\_STA}}

\end{itemize}

\sphinxcode{\sphinxupquote{P\_maxlag}}
\begin{itemize}
\item {} 
The maximum number of moveable sampling points to fitting waveform of P wave.
It is generally half the period of the P phase waveform. unit/s.

\end{itemize}

\sphinxcode{\sphinxupquote{S\_maxlag}}
\begin{itemize}
\item {} 
The maximum number of moveable sampling points to fitting waveform of S wave.

\end{itemize}

\sphinxcode{\sphinxupquote{Surf\_maxlag}}
\begin{itemize}
\item {} 
The maximum number of moveable sampling points to fitting waveform of Surf wave.

\end{itemize}

\sphinxcode{\sphinxupquote{P\_filter}}
\begin{itemize}
\item {} 
P wave filter range, {[}freqmin, freqmax{]}.

\end{itemize}

\sphinxcode{\sphinxupquote{S\_filter}}
\begin{itemize}
\item {} 
S wave filter range, {[}freqmin, freqmax{]}.

\end{itemize}

\sphinxcode{\sphinxupquote{Surf\_filter}}
\begin{itemize}
\item {} 
Surf wave filter range, {[}freqmin, freqmax{]}.

\end{itemize}


\subsubsection{Inversion parameters}
\label{\detokenize{tutorials/S4_Inv_DC:inversion-parameters}}
\sphinxcode{\sphinxupquote{InvType}}
\begin{itemize}
\item {} 
The type of source, mt(moment tensor) dc(double\sphinxhyphen{}couple) sf(single\sphinxhyphen{}couple) ep(explosion).

\end{itemize}

\sphinxcode{\sphinxupquote{FM0}}
\begin{itemize}
\item {} 
The initial value of the inversion, it’s a 1\sphinxhyphen{}d list.

\item {} 
dc:{[}m0, str, dip rake, lat, lon, depth, t0{]} || mt:{[}m0, m\_xx, m\_xy, m\_xz, m\_yy, m\_yz, m\_zz, lat, lon, depth, t0{]} || ep:{[}m0{]}

\item {} 
The default initial value of t0 is usually 0.

\end{itemize}

\sphinxcode{\sphinxupquote{Fixed\_FM}}
\begin{itemize}
\item {} 
The length of the list corresponds to \sphinxcode{\sphinxupquote{FM0}}, and ‘constant’ means fixed to a constant and unchanged in the inversion process.
‘variable’ is represented as a variable and participates in the inversion.

\end{itemize}

\sphinxcode{\sphinxupquote{FM\_boundary}}
\begin{itemize}
\item {} 
A 2\sphinxhyphen{}d list, FM’s boundary.

\end{itemize}

\sphinxcode{\sphinxupquote{Noise\_level\_waveform}}
\begin{itemize}
\item {} 
Noise level estimation of raw data.

\end{itemize}

\sphinxcode{\sphinxupquote{MISFIT0}}
\begin{itemize}
\item {} 
The initial error of the objective function, usually set to a very large value.

\end{itemize}

\sphinxcode{\sphinxupquote{alpha\_max}}
\begin{itemize}
\item {} 
The initial value of \sphinxstylestrong{alpha}.

\end{itemize}

\sphinxcode{\sphinxupquote{alpha\_min}}
\begin{itemize}
\item {} 
The final value of \sphinxstylestrong{alpha}.

\end{itemize}

\sphinxcode{\sphinxupquote{a}}
\begin{itemize}
\item {} 
The alpha function’s parameter.

\end{itemize}

\sphinxcode{\sphinxupquote{b}}
\begin{itemize}
\item {} 
The alpha function’s parameter.

\end{itemize}

\sphinxcode{\sphinxupquote{sigma\_mw}}
\begin{itemize}
\item {} 
The standard deviation of the new solution of \sphinxstylestrong{Mw}.

\end{itemize}

\sphinxcode{\sphinxupquote{sigma\_mt}}
\begin{itemize}
\item {} 
The standard deviation of the new solution of \sphinxstylestrong{Moment Tensor}.

\end{itemize}

\sphinxcode{\sphinxupquote{sigma\_dc}}
\begin{itemize}
\item {} 
The standard deviation of the new solution of \sphinxstylestrong{Strike Dip Rake}.

\end{itemize}

\sphinxcode{\sphinxupquote{sigma\_sf}}
\begin{itemize}
\item {} 
The standard deviation of the new solution of \sphinxstylestrong{Single Couple} (not test now).

\end{itemize}

\sphinxcode{\sphinxupquote{sigma\_ep}}
\begin{itemize}
\item {} 
The standard deviation of the new solution of \sphinxstylestrong{Explosion}  (not test now).

\end{itemize}

\sphinxcode{\sphinxupquote{sigma\_lat\_lon}}
\begin{itemize}
\item {} 
The standard deviation of the new solution of \sphinxstylestrong{Latitude and Longitude} (degree).

\end{itemize}

\sphinxcode{\sphinxupquote{sigma\_depth}}
\begin{itemize}
\item {} 
The standard deviation of the new solution of \sphinxstylestrong{Source Depth} (km).

\end{itemize}

\sphinxcode{\sphinxupquote{sigma\_t}}
\begin{itemize}
\item {} 
The standard deviation of the new solution of \sphinxstylestrong{T0} (s).

\end{itemize}


\subsubsection{Alpha}
\label{\detokenize{tutorials/S4_Inv_DC:alpha}}\begin{itemize}
\item {} 
The \sphinxstylestrong{alpha} function is shown in following script, you can test different parameters
\sphinxcode{\sphinxupquote{alpha\_max}}
\sphinxcode{\sphinxupquote{alpha\_min}}
\sphinxcode{\sphinxupquote{a}}
\sphinxcode{\sphinxupquote{b}}
and plot thefigure.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}*\PYGZhy{} coding: utf\PYGZhy{}8 \PYGZhy{}*\PYGZhy{}}
\PYG{k+kn}{import} \PYG{n+nn}{math}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}

\PYG{c+c1}{\PYGZsh{} parameters}
\PYG{n}{N}\PYG{o}{=}\PYG{l+m+mf}{5e3}
\PYG{n}{a}\PYG{o}{=}\PYG{l+m+mi}{1000}                  \PYG{c+c1}{\PYGZsh{} 0.2*N}
\PYG{n}{b}\PYG{o}{=}\PYG{l+m+mi}{100}                   \PYG{c+c1}{\PYGZsh{} 0.04*N}
\PYG{n}{alpha\PYGZus{}max}\PYG{o}{=}\PYG{l+m+mi}{100}
\PYG{n}{alpha\PYGZus{}min}\PYG{o}{=}\PYG{l+m+mi}{0}

\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} we expect no parameters need to be changed below}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{n}{tt}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{N}\PYG{p}{)}\PYG{p}{,} \PYG{n}{num}\PYG{o}{=}\PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{N}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{yy}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{tt}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{tt}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{yy}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{=}\PYG{p}{(}\PYG{n}{alpha\PYGZus{}max}\PYG{o}{\PYGZhy{}}\PYG{n}{alpha\PYGZus{}min}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{a}\PYG{o}{+}\PYG{n}{math}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{p}{(}\PYG{n}{tt}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{a}\PYG{p}{)}\PYG{o}{/}\PYG{n}{b}\PYG{p}{)}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{a}\PYG{o}{+}\PYG{n}{math}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{p}{(}\PYG{n}{tt}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{a}\PYG{p}{)}\PYG{o}{/}\PYG{n}{b}\PYG{p}{)}\PYG{p}{)}\PYG{o}{+}\PYG{n}{alpha\PYGZus{}min}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{axs} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{axs}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{tt}\PYG{p}{,}\PYG{n}{yy}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{lw}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.6}\PYG{p}{)}
\PYG{n}{axs}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Sample Number}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{17}\PYG{p}{)}
\PYG{n}{axs}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Alpha Value}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{17}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Logging file}
\label{\detokenize{tutorials/S4_Inv_DC:logging-file}}\begin{itemize}
\item {} 
\sphinxstylestrong{MCMTpy} will generates 1 logging files when it do \sphinxstylestrong{Inversion}, that is \sphinxstylestrong{Inv\_para\_info.txt}.
They record all the parameter information of inversion process. You can find them
in \sphinxcode{\sphinxupquote{Output\_path}} path.

\end{itemize}


\subsubsection{Example Double\sphinxhyphen{}Couple Inv}
\label{\detokenize{tutorials/S4_Inv_DC:example-double-couple-inv}}\begin{itemize}
\item {} 
The \sphinxstylestrong{example\_path} need to de changed to your path, and run this notebook to set \sphinxstylestrong{sample\_dc.json} file.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}*\PYGZhy{} coding: utf\PYGZhy{}8 \PYGZhy{}*\PYGZhy{}}

\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{sys}
\PYG{k+kn}{import} \PYG{n+nn}{json5}


\PYG{c+c1}{\PYGZsh{} The root directory of the project}
\PYG{n}{example\PYGZus{}path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/Users/yf/3.Project/8.MCMTpy/MCMTpy\PYGZhy{}master/data/example\PYGZus{}yunnan}\PYG{l+s+s1}{\PYGZsq{}}


\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} we expect no parameters need to be changed below}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} 1. get notebook path}
\PYG{n}{notebook\PYGZus{}path} \PYG{o}{=} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{path}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{n}{notebook\PYGZus{}path}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} change path to Green\PYGZus{}Funcs}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../YN.202105212148\PYGZus{}Inv/dc\PYGZus{}inv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 2.show build\PYGZus{}GFs.json }
\PYG{n}{filename} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sample\PYGZus{}dc.json}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{filename}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{encoding}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{utf\PYGZhy{}8}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f1}\PYG{p}{:}
    \PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{o}{=}\PYG{n}{json5}\PYG{o}{.}\PYG{n}{load}\PYG{p}{(}\PYG{n}{f1}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 3.change parameters with absolute path}
\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GFs\PYGZus{}json\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Green\PYGZus{}Funcs/build\PYGZus{}GFs\PYGZus{}new.json}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GFs\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=}\PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Green\PYGZus{}Funcs/GFs/GFs\PYGZus{}splits}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{)}          
\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Raw\PYGZus{}data\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{YN.202105212148\PYGZus{}Inv/YN.202105212148\PYGZus{}MCMTpy/YN.202105212148.h5}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}              
\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Output\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{YN.202105212148\PYGZus{}Inv/dc\PYGZus{}inv/Output\PYGZus{}YN.202105212148\PYGZus{}dc}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}         
\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Raw\PYGZus{}data\PYGZus{}inv\PYGZus{}info}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{YN.202105212148\PYGZus{}Inv/dc\PYGZus{}inv/Raw\PYGZus{}data\PYGZus{}inv\PYGZus{}info.txt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}     
\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Raw\PYGZus{}data\PYGZus{}inv\PYGZus{}info\PYGZus{}writed}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{YN.202105212148\PYGZus{}Inv/dc\PYGZus{}inv/Raw\PYGZus{}data\PYGZus{}inv\PYGZus{}info\PYGZus{}writed.txt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} 
\PYG{n}{sample\PYGZus{}dc\PYGZus{}json\PYGZus{}new} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YN.202105212148\PYGZus{}Inv/dc\PYGZus{}inv/sample\PYGZus{}dc\PYGZus{}new.json}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{MPI\PYGZus{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{4}                         \PYG{c+c1}{\PYGZsh{} CPU num}
\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Chains\PYGZus{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{4}                      \PYG{c+c1}{\PYGZsh{} Each MK\PYGZhy{}chains num}
\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{N}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{1e1}                           \PYG{c+c1}{\PYGZsh{} each chain‘s search number}

\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{alpha\PYGZus{}max}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{100}                   \PYG{c+c1}{\PYGZsh{} The initial value of alpha}
\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{alpha\PYGZus{}min}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0}                     \PYG{c+c1}{\PYGZsh{} The final value of alpha}
\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{a}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{10}                     
\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{b}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{10}               

\PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{sample\PYGZus{}dc\PYGZus{}json\PYGZus{}new}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f2}\PYG{p}{:}
    \PYG{n}{json5}\PYG{o}{.}\PYG{n}{dump}\PYG{p}{(}\PYG{n}{sample\PYGZus{}dc\PYGZus{}json}\PYG{p}{,} \PYG{n}{f2}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{f2}\PYG{o}{.}\PYG{n}{close}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 4.run MCMTpy in shell}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{n}{notebook\PYGZus{}path}\PYG{p}{)}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../YN.202105212148\PYGZus{}Inv/dc\PYGZus{}inv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} !MCMTpy  sample MH  \PYGZhy{}c ./sample\PYGZus{}dc\PYGZus{}new.json \PYGZsh{}\PYGZgt{} sample.log}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
Now you can run MCMTpy in bash:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} MCMTpy  sample MH  \PYGZhy{}c ./sample\PYGZus{}dc\PYGZus{}new.json \PYGZgt{} sample.log
\end{sphinxVerbatim}

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
Please follow the above parameter instructions and set all parameters correctly before running the program.
Otherwise, it is easy to report an error!
\end{sphinxadmonition}


\subsection{Result Visualization}
\label{\detokenize{tutorials/S5_Plot_Result:result-visualization}}\label{\detokenize{tutorials/S5_Plot_Result::doc}}
\begin{sphinxShadowBox}
\begin{itemize}
\item {} 
\phantomsection\label{\detokenize{tutorials/S5_Plot_Result:id1}}{\hyperref[\detokenize{tutorials/S5_Plot_Result:path}]{\sphinxcrossref{Path}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S5_Plot_Result:id2}}{\hyperref[\detokenize{tutorials/S5_Plot_Result:hist}]{\sphinxcrossref{Hist}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S5_Plot_Result:id3}}{\hyperref[\detokenize{tutorials/S5_Plot_Result:misfit}]{\sphinxcrossref{Misfit}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S5_Plot_Result:id4}}{\hyperref[\detokenize{tutorials/S5_Plot_Result:waveform}]{\sphinxcrossref{Waveform}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S5_Plot_Result:id5}}{\hyperref[\detokenize{tutorials/S5_Plot_Result:example}]{\sphinxcrossref{Example}}}

\end{itemize}
\end{sphinxShadowBox}
\begin{itemize}
\item {} 
This is the plotting script of the MCMTpy, and all parameters are written into a JSON file named \sphinxstylestrong{plot.json}.
Some brief descriptions of the parameters are included here following the definination.

\item {} 
We do not recommend using relative paths because of the possibility of errors. \sphinxstylestrong{Absolute paths} are preferred.

\end{itemize}


\subsubsection{Path}
\label{\detokenize{tutorials/S5_Plot_Result:path}}
\sphinxcode{\sphinxupquote{plot\_output\_path}},
\begin{itemize}
\item {} 
Plot result output file path.

\end{itemize}

\sphinxcode{\sphinxupquote{Inv\_json\_file}},
\begin{itemize}
\item {} 
The path to the Json\sphinxhyphen{}file used in inversion.

\end{itemize}

\sphinxcode{\sphinxupquote{fig\_format}},
\begin{itemize}
\item {} 
Output figure format.

\end{itemize}


\subsubsection{Hist}
\label{\detokenize{tutorials/S5_Plot_Result:hist}}
\sphinxcode{\sphinxupquote{plot\_hist}}
\begin{itemize}
\item {} 
Whether to plot hist\sphinxhyphen{}figure.

\end{itemize}

\sphinxcode{\sphinxupquote{N\_start}}
\begin{itemize}
\item {} 
The sequence number of all\sphinxhyphen{}FM Markov chain to plot in hist\sphinxhyphen{}figure.

\end{itemize}

\sphinxcode{\sphinxupquote{N\_start\_accept}}
\begin{itemize}
\item {} 
The sequence number of all\sphinxhyphen{}accept\sphinxhyphen{}FM Markov chain to plot in hist\sphinxhyphen{}figure.

\end{itemize}

\sphinxcode{\sphinxupquote{num\_bins}}
\begin{itemize}
\item {} 
Number of grids to draw in hist\sphinxhyphen{}figure.

\end{itemize}

\sphinxcode{\sphinxupquote{num\_std}}
\begin{itemize}
\item {} 
Range of axes in each subgraph (mean +\sphinxhyphen{} several times standard deviation). \sphinxcode{\sphinxupquote{num\_std}} means \sphinxstyleemphasis{n} times standard deviation.

\end{itemize}

\sphinxcode{\sphinxupquote{labels\_name}}
\begin{itemize}
\item {} 
Labels’ name, it’s depend on the number parameters that you want to inverse.

\item {} 
eg: dc–> {[}‘mw’,’strike/°’,’dip/°’,’rake/°’,’x/km’,’y/km’,’z/km’,’t0/s’{]}.

\item {} 
eg: mt–> {[}‘Mw’,  ‘Mxx’,  ‘Myy’,  ‘Mzz’,  ‘Mxy’,  ‘Mxz’,  ‘Myz’, ‘x/km’, ‘y/km’, ‘z/km’, ‘t0/s’{]}.

\end{itemize}


\subsubsection{Misfit}
\label{\detokenize{tutorials/S5_Plot_Result:misfit}}
\sphinxcode{\sphinxupquote{plot\_misfit}}
\begin{itemize}
\item {} 
Whether to plot misfit\sphinxhyphen{}figure.

\end{itemize}

\sphinxcode{\sphinxupquote{MPI\_n\_st}}
\begin{itemize}
\item {} 
Which MPI’s misfit do you want to draw in figure.

\end{itemize}

\sphinxcode{\sphinxupquote{Chains\_n\_st}}
\begin{itemize}
\item {} 
Which Chains’s misfit do you want to draw in figure.

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
We can only specify a chain of an MPI to draw misfit\sphinxhyphen{}figure.
\end{sphinxadmonition}


\subsubsection{Waveform}
\label{\detokenize{tutorials/S5_Plot_Result:waveform}}
\sphinxcode{\sphinxupquote{plot\_waveform}}
\begin{itemize}
\item {} 
Whether to plot waveform\sphinxhyphen{}figure.

\end{itemize}

\sphinxcode{\sphinxupquote{NET\_STA}}
\begin{itemize}
\item {} 
The information contained in the two\sphinxhyphen{}dimensional list: {[}network\_name{]} {[}station\_name{]}  {[}station\_lat{]}   {[}source\_lon{]}    {[}station\_depth{]}

\end{itemize}

\sphinxcode{\sphinxupquote{FM\_best}}
\begin{itemize}
\item {} 
The best focal mechanism, it’s a 1\sphinxhyphen{}d list.

\item {} 
dc:{[}m0, str, dip rake, lat, lon, depth, t0{]} || mt:{[}m0, m\_xx, m\_xy, m\_xz, m\_yy, m\_yz, m\_zz, lat, lon, depth, t0{]} || ep:{[}m0{]}

\end{itemize}

\sphinxcode{\sphinxupquote{line\_n\_sta}}
\begin{itemize}
\item {} 
Draw several stations per row in waveform\sphinxhyphen{}figure.

\end{itemize}

\sphinxcode{\sphinxupquote{max\_p\_ylim}}
\begin{itemize}
\item {} 
The maximum amplitude of P wave drawing in waveform\sphinxhyphen{}figure.

\end{itemize}

\sphinxcode{\sphinxupquote{max\_s\_ylim}}
\begin{itemize}
\item {} 
The maximum amplitude of S wave drawing in waveform\sphinxhyphen{}figure.

\end{itemize}

\sphinxcode{\sphinxupquote{max\_surf\_ylim}}
\begin{itemize}
\item {} 
The maximum amplitude of Surf wave drawing in waveform\sphinxhyphen{}figure.

\end{itemize}

\sphinxcode{\sphinxupquote{plot\_comp}}
\begin{itemize}
\item {} 
Which components of the waveform that you want to plot in waveform\sphinxhyphen{}figure.

\item {} 
The 2\sphinxhyphen{}d list represent the three components of P, S and Surf, respectively ZRT.

\end{itemize}

\sphinxcode{\sphinxupquote{plot\_comp\_name}}
\begin{itemize}
\item {} 
Labels’ name, it’s depend on the number parameters that you want to plot with \sphinxcode{\sphinxupquote{plot\_comp}}.

\end{itemize}


\subsubsection{Example}
\label{\detokenize{tutorials/S5_Plot_Result:example}}\begin{itemize}
\item {} 
The \sphinxstylestrong{example\_path} need to de changed to your path, and run this notebook to set \sphinxstylestrong{sample\_dc.json} file.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}*\PYGZhy{} coding: utf\PYGZhy{}8 \PYGZhy{}*\PYGZhy{}}

\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{sys}
\PYG{k+kn}{import} \PYG{n+nn}{json5}

\PYG{c+c1}{\PYGZsh{} The root directory of the project}
\PYG{n}{example\PYGZus{}path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/Users/yf/3.Project/8.MCMTpy/MCMTpy\PYGZhy{}master/data/example\PYGZus{}yunnan}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} we expect no parameters need to be changed below}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} 1. get notebook path}
\PYG{n}{notebook\PYGZus{}path} \PYG{o}{=} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{path}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{n}{notebook\PYGZus{}path}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 2.change path to Green\PYGZus{}Funcs}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{n}{notebook\PYGZus{}path}\PYG{p}{)}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../YN.202105212148\PYGZus{}Inv/dc\PYGZus{}inv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{os}\PYG{o}{.}\PYG{n}{listdir}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 3.read plot\PYGZus{}dc.json }
\PYG{n}{filename} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{plot\PYGZus{}dc.json}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{filename}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{encoding}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{utf\PYGZhy{}8}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f1}\PYG{p}{:}
    \PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{o}{=}\PYG{n}{json5}\PYG{o}{.}\PYG{n}{load}\PYG{p}{(}\PYG{n}{f1}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 4.change parameters with absolute path}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{plot\PYGZus{}output\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{YN.202105212148\PYGZus{}Inv/dc\PYGZus{}inv/figure\PYGZus{}dc}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Inv\PYGZus{}json\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{YN.202105212148\PYGZus{}Inv/dc\PYGZus{}inv/sample\PYGZus{}dc\PYGZus{}new.json}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} 
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json\PYGZus{}new} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YN.202105212148\PYGZus{}Inv/dc\PYGZus{}inv/plot\PYGZus{}dc\PYGZus{}new.json}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 5.hist}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{plot\PYGZus{}hist}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=}\PYG{k+kc}{True}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{N\PYGZus{}start}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0} 
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{N\PYGZus{}start\PYGZus{}accept}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{num\PYGZus{}bins}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=}  \PYG{l+m+mi}{50}     
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{num\PYGZus{}std}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=}\PYG{l+m+mi}{5}      
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{labels\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Mw}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{strike/°}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dip/°}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rake/°}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{z/km}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{} 6. misfit}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{plot\PYGZus{}misfit}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{True}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{MPI\PYGZus{}n\PYGZus{}st}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Chains\PYGZus{}n\PYGZus{}st}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0}

\PYG{c+c1}{\PYGZsh{} 7. waveform}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{plot\PYGZus{}waveform}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{True}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{FM\PYGZus{}best}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mf}{6.68}\PYG{p}{,}  \PYG{l+m+mf}{135.1}\PYG{p}{,}  \PYG{l+m+mf}{87.0}\PYG{p}{,}  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{168.1}\PYG{p}{,}    \PYG{l+m+mf}{25.58}\PYG{p}{,}  \PYG{l+m+mf}{99.86}\PYG{p}{,}  \PYG{l+m+mf}{5.95}\PYG{p}{,}  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.57} \PYG{p}{]}     
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{line\PYGZus{}n\PYGZus{}sta}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{3}                                     \PYG{c+c1}{\PYGZsh{} Draw the data of several stations in a row}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{max\PYGZus{}p\PYGZus{}ylim}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}                                     \PYG{c+c1}{\PYGZsh{} max amp y\PYGZhy{}axis of p wave}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{max\PYGZus{}s\PYGZus{}ylim}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{1.0}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{max\PYGZus{}surf\PYGZus{}ylim}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{plot\PYGZus{}comp}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}              \PYG{c+c1}{\PYGZsh{} What components do you want to draw? P、S、Surf\PYGZsq{}s Z/R/T}


\PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{plot\PYGZus{}dc\PYGZus{}json\PYGZus{}new}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f2}\PYG{p}{:}
    \PYG{n}{json5}\PYG{o}{.}\PYG{n}{dump}\PYG{p}{(}\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{,} \PYG{n}{f2}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{f2}\PYG{o}{.}\PYG{n}{close}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 8.run MCMTpy in shell}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{n}{notebook\PYGZus{}path}\PYG{p}{)}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{chdir}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../YN.202105212148\PYGZus{}Inv/dc\PYGZus{}inv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} !MCMTpy plot pyfk \PYGZhy{}c plot\PYGZus{}dc\PYGZus{}new.json \PYGZgt{} plot.log}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
Now you can run MCMTpy in bash:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{} MCMTpy plot pyfk \PYGZhy{}c plot\PYGZus{}dc\PYGZus{}new.json
\end{sphinxVerbatim}

\item {} 
Show hist in jupyter notebook:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fig\PYGZus{}hist} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{plot\PYGZus{}output\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hist.jpg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{Image}\PYG{p}{(}\PYG{n}{filename} \PYG{o}{=} \PYG{n}{fig\PYGZus{}hist}\PYG{p}{,} \PYG{n}{width}\PYG{o}{=}\PYG{l+m+mi}{600}\PYG{p}{)}
\end{sphinxVerbatim}

\end{itemize}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{hist1}.png}\hspace*{\fill}}
\begin{itemize}
\item {} 
Show hist\_accept in jupyter notebook:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fig\PYGZus{}hist\PYGZus{}accept} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{plot\PYGZus{}output\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hist\PYGZus{}accept.jpg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{Image}\PYG{p}{(}\PYG{n}{filename} \PYG{o}{=} \PYG{n}{fig\PYGZus{}hist\PYGZus{}accept}\PYG{p}{,} \PYG{n}{width}\PYG{o}{=}\PYG{l+m+mi}{600}\PYG{p}{)}
\end{sphinxVerbatim}

\end{itemize}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{hist_accept}.png}\hspace*{\fill}}
\begin{itemize}
\item {} 
Show misfit in jupyter notebook:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fig\PYGZus{}misfit} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{plot\PYGZus{}output\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{misfit.jpg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{Image}\PYG{p}{(}\PYG{n}{filename} \PYG{o}{=} \PYG{n}{fig\PYGZus{}misfit}\PYG{p}{,} \PYG{n}{width}\PYG{o}{=}\PYG{l+m+mi}{600}\PYG{p}{)}
\end{sphinxVerbatim}

\end{itemize}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{misfit1}.png}\hspace*{\fill}}
\begin{itemize}
\item {} 
Show waveform in jupyter notebook:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fig\PYGZus{}waveform} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{plot\PYGZus{}dc\PYGZus{}json}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{plot\PYGZus{}output\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{waveform.jpg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{Image}\PYG{p}{(}\PYG{n}{filename} \PYG{o}{=} \PYG{n}{fig\PYGZus{}waveform}\PYG{p}{,} \PYG{n}{width}\PYG{o}{=}\PYG{l+m+mi}{1000}\PYG{p}{)}
\end{sphinxVerbatim}

\end{itemize}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{waveform1}.png}\hspace*{\fill}}

\begin{sphinxadmonition}{note}{Note:}
Please follow the above parameter instructions and set all parameters correctly before running the program.
Otherwise, it is easy to report an error!
\end{sphinxadmonition}


\subsection{Conversion of Source Parameters}
\label{\detokenize{tutorials/S6_Conver_FM:conversion-of-source-parameters}}\label{\detokenize{tutorials/S6_Conver_FM::doc}}\begin{itemize}
\item {} 
The MCMTpy provides a series of scripts for source parameter calculation and conversion. The MomentTensor script refers
to some theories and codes of \sphinxhref{https://github.com/obspy/obspy}{Obspy}%
\begin{footnote}[10]\sphinxAtStartFootnote
\sphinxnolinkurl{https://github.com/obspy/obspy}
%
\end{footnote} \sphinxhref{https://github.com/geophysics/MoPaD}{MoPaD}%
\begin{footnote}[11]\sphinxAtStartFootnote
\sphinxnolinkurl{https://github.com/geophysics/MoPaD}
%
\end{footnote} and
Introduction to Seismology (Yongge Wan), mainly including:

\end{itemize}

\begin{sphinxShadowBox}
\begin{itemize}
\item {} 
\phantomsection\label{\detokenize{tutorials/S6_Conver_FM:id1}}{\hyperref[\detokenize{tutorials/S6_Conver_FM:the-installation}]{\sphinxcrossref{The installation}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S6_Conver_FM:id2}}{\hyperref[\detokenize{tutorials/S6_Conver_FM:str-dip-rake-to-mt}]{\sphinxcrossref{str\_dip\_rake to mt}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S6_Conver_FM:id3}}{\hyperref[\detokenize{tutorials/S6_Conver_FM:the-conversion-between-str-dip-rake-and-a-n-vector}]{\sphinxcrossref{The conversion between str\_dip\_rake and A/N vector}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S6_Conver_FM:id4}}{\hyperref[\detokenize{tutorials/S6_Conver_FM:the-conversion-between-a-n-vector-and-p-t-n-vector}]{\sphinxcrossref{The conversion between A/N vector and P/T/N vector}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S6_Conver_FM:id5}}{\hyperref[\detokenize{tutorials/S6_Conver_FM:mt-to-p-t-n-vector}]{\sphinxcrossref{mt to P/T/N vector}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S6_Conver_FM:id6}}{\hyperref[\detokenize{tutorials/S6_Conver_FM:p-t-n-vector-to-p-t-n-vector-s-stirke-and-dip}]{\sphinxcrossref{P/T/N vector to P/T/N vector’s stirke and dip}}}

\item {} 
\phantomsection\label{\detokenize{tutorials/S6_Conver_FM:id7}}{\hyperref[\detokenize{tutorials/S6_Conver_FM:describe-fault-plane-with-two-str-dip-rake}]{\sphinxcrossref{Describe\_fault\_plane with two str\_dip\_rake}}}

\end{itemize}
\end{sphinxShadowBox}
\begin{itemize}
\item {} 
We do not recommend using relative paths because of the possibility of errors. Absolute paths are preferred.

\end{itemize}


\subsubsection{The installation}
\label{\detokenize{tutorials/S6_Conver_FM:the-installation}}\begin{itemize}
\item {} 
jupyter notebook:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} import MomentTensor}
\PYG{k+kn}{from} \PYG{n+nn}{MCMTpy} \PYG{k+kn}{import} \PYG{n}{MomentTensor} \PYG{k}{as} \PYG{n}{MTpy}

\PYG{c+c1}{\PYGZsh{} get \PYGZus{}\PYGZus{}doc\PYGZus{}\PYGZus{}}
\PYG{n}{MTpy}\PYG{o}{.}\PYG{n+nv+vm}{\PYGZus{}\PYGZus{}doc\PYGZus{}\PYGZus{}}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{itemize}


\subsubsection{str\_dip\_rake to mt}
\label{\detokenize{tutorials/S6_Conver_FM:str-dip-rake-to-mt}}\begin{itemize}
\item {} 
jupyter notebook:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} function: str\PYGZus{}dip\PYGZus{}rake2MT}
\PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{str\PYGZus{}dip\PYGZus{}rake2MT}\PYG{o}{.}\PYG{n+nv+vm}{\PYGZus{}\PYGZus{}doc\PYGZus{}\PYGZus{}}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} input}
\PYG{n}{strike} \PYG{o}{=} \PYG{l+m+mi}{50}
\PYG{n}{dip} \PYG{o}{=} \PYG{l+m+mi}{50}
\PYG{n}{rake} \PYG{o}{=} \PYG{l+m+mi}{100}

\PYG{n}{A} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{str\PYGZus{}dip\PYGZus{}rake2MT}\PYG{p}{(}\PYG{n}{strike}\PYG{p}{,}\PYG{n}{dip}\PYG{p}{,}\PYG{n}{rake}\PYG{p}{)}
\PYG{n}{A}\PYG{o}{.}\PYG{n}{mt}
\end{sphinxVerbatim}

\end{itemize}


\subsubsection{The conversion between str\_dip\_rake and A/N vector}
\label{\detokenize{tutorials/S6_Conver_FM:the-conversion-between-str-dip-rake-and-a-n-vector}}\begin{itemize}
\item {} 
jupyter notebook:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} function: str\PYGZus{}dip\PYGZus{}rake2AN}
\PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{str\PYGZus{}dip\PYGZus{}rake2AN}\PYG{o}{.}\PYG{n+nv+vm}{\PYGZus{}\PYGZus{}doc\PYGZus{}\PYGZus{}}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} str\PYGZus{}dip\PYGZus{}rake to A/N vector}
\PYG{c+c1}{\PYGZsh{} input}
\PYG{n}{strike} \PYG{o}{=} \PYG{l+m+mi}{50}
\PYG{n}{dip} \PYG{o}{=} \PYG{l+m+mi}{50}
\PYG{n}{rake} \PYG{o}{=} \PYG{l+m+mi}{100}

\PYG{n}{A}\PYG{p}{,}\PYG{n}{N} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{str\PYGZus{}dip\PYGZus{}rake2AN}\PYG{p}{(}\PYG{n}{strike}\PYG{p}{,}\PYG{n}{dip}\PYG{p}{,}\PYG{n}{rake}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{A}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{N}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} function AN2str\PYGZus{}dip\PYGZus{}rake}
\PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{AN2str\PYGZus{}dip\PYGZus{}rake}\PYG{o}{.}\PYG{n+nv+vm}{\PYGZus{}\PYGZus{}doc\PYGZus{}\PYGZus{}}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} A/N vector to str\PYGZus{}dip\PYGZus{}rake}
\PYG{c+c1}{\PYGZsh{} input}
\PYG{n}{A} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.37330426}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.53992106}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.75440651}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{N} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.58682409}\PYG{p}{,}  \PYG{l+m+mf}{0.49240388}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.64278761}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{DD} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{AN2str\PYGZus{}dip\PYGZus{}rake}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,}\PYG{n}{N}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{strike = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{DD}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dip = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{DD}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rake = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{DD}\PYG{o}{.}\PYG{n}{rake}\PYG{p}{)}
\end{sphinxVerbatim}

\end{itemize}


\subsubsection{The conversion between A/N vector and P/T/N vector}
\label{\detokenize{tutorials/S6_Conver_FM:the-conversion-between-a-n-vector-and-p-t-n-vector}}\begin{itemize}
\item {} 
jupyter notebook:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} function AN2TPN}
\PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{AN2TPN}\PYG{o}{.}\PYG{n+nv+vm}{\PYGZus{}\PYGZus{}doc\PYGZus{}\PYGZus{}}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Calculate the T\PYGZhy{}axis, P\PYGZhy{}axis and N\PYGZhy{}axis according to the slip vector (A) and fault plane direction vector (N)}
\PYG{c+c1}{\PYGZsh{} input}
\PYG{n}{A} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.37330426}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.53992106}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.75440651}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{N} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.58682409}\PYG{p}{,}  \PYG{l+m+mf}{0.49240388}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.64278761}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{T}\PYG{p}{,}\PYG{n}{P}\PYG{p}{,}\PYG{n}{Null} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{AN2TPN}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,}\PYG{n}{N}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{P = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{P}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Null = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{Null}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} function TP2AN}
\PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{TP2AN}\PYG{o}{.}\PYG{n+nv+vm}{\PYGZus{}\PYGZus{}doc\PYGZus{}\PYGZus{}}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Calculate the slip vector (A) and fault plane direction vector (N) according to the T\PYGZhy{}axis and P\PYGZhy{}axis}
\PYG{c+c1}{\PYGZsh{} input}
\PYG{n}{T} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.15098132}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.03359972}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.98796544}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{P} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.67891327}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.72996397}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.07892648}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{A}\PYG{p}{,}\PYG{n}{N} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{TP2AN}\PYG{p}{(}\PYG{n}{T}\PYG{p}{,}\PYG{n}{P}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{A}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{N}\PYG{p}{)}
\end{sphinxVerbatim}

\end{itemize}


\subsubsection{mt to P/T/N vector}
\label{\detokenize{tutorials/S6_Conver_FM:mt-to-p-t-n-vector}}\begin{itemize}
\item {} 
jupyter notebook:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} function MT2TPN}
\PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MT2TPN}\PYG{o}{.}\PYG{n+nv+vm}{\PYGZus{}\PYGZus{}doc\PYGZus{}\PYGZus{}}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} input}
\PYG{n}{strike} \PYG{o}{=} \PYG{l+m+mi}{50}
\PYG{n}{dip} \PYG{o}{=} \PYG{l+m+mi}{50}
\PYG{n}{rake} \PYG{o}{=} \PYG{l+m+mi}{100}

\PYG{n}{A} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{str\PYGZus{}dip\PYGZus{}rake2MT}\PYG{p}{(}\PYG{n}{strike}\PYG{p}{,}\PYG{n}{dip}\PYG{p}{,}\PYG{n}{rake}\PYG{p}{)}
\PYG{n}{T}\PYG{p}{,} \PYG{n}{P}\PYG{p}{,} \PYG{n}{Null} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MT2TPN}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{P = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{P}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Null = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{Null}\PYG{p}{)}
\end{sphinxVerbatim}

\end{itemize}


\subsubsection{P/T/N vector to P/T/N vector’s stirke and dip}
\label{\detokenize{tutorials/S6_Conver_FM:p-t-n-vector-to-p-t-n-vector-s-stirke-and-dip}}\begin{itemize}
\item {} 
jupyter notebook:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} function vector2str\PYGZus{}dip}
\PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{o}{.}\PYG{n+nv+vm}{\PYGZus{}\PYGZus{}doc\PYGZus{}\PYGZus{}}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} input}
\PYG{n}{A} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.37330426}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.53992106}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.75440651}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{CC} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A.strike = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{CC}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A.dip = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{CC}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}
\end{sphinxVerbatim}

\end{itemize}


\subsubsection{Describe\_fault\_plane with two str\_dip\_rake}
\label{\detokenize{tutorials/S6_Conver_FM:describe-fault-plane-with-two-str-dip-rake}}\begin{itemize}
\item {} 
jupyter notebook:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} function describe\PYGZus{}fault\PYGZus{}plane}
\PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{describe\PYGZus{}fault\PYGZus{}plane}\PYG{o}{.}\PYG{n+nv+vm}{\PYGZus{}\PYGZus{}doc\PYGZus{}\PYGZus{}}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} input}
\PYG{n}{strike} \PYG{o}{=} \PYG{l+m+mi}{50}
\PYG{n}{dip} \PYG{o}{=} \PYG{l+m+mi}{50}
\PYG{n}{rake} \PYG{o}{=} \PYG{l+m+mi}{100}

\PYG{n}{A} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{str\PYGZus{}dip\PYGZus{}rake2MT}\PYG{p}{(}\PYG{n}{strike}\PYG{p}{,}\PYG{n}{dip}\PYG{p}{,}\PYG{n}{rake}\PYG{p}{)}
\PYG{n}{CC} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{describe\PYGZus{}fault\PYGZus{}plane}\PYG{p}{(}\PYG{n}{A}\PYG{o}{.}\PYG{n}{mt}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FM\PYGZus{}1 = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{CC}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FM\PYGZus{}2 = }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{CC}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\end{itemize}


\subsection{Plot Beachball with Station Projected}
\label{\detokenize{tutorials/S7_Plot_Beachball:plot-beachball-with-station-projected}}\label{\detokenize{tutorials/S7_Plot_Beachball::doc}}\begin{itemize}
\item {} 
The \sphinxstylestrong{example\_path} need to de changed to your path, and run this notebook.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}*\PYGZhy{} coding: utf\PYGZhy{}8 \PYGZhy{}*\PYGZhy{}}
\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{glob}
\PYG{k+kn}{import} \PYG{n+nn}{obspy}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{from} \PYG{n+nn}{obspy} \PYG{k+kn}{import} \PYG{n}{Stream}
\PYG{k+kn}{from} \PYG{n+nn}{obspy}\PYG{n+nn}{.}\PYG{n+nn}{taup} \PYG{k+kn}{import} \PYG{n}{TauPyModel}
\PYG{k+kn}{from} \PYG{n+nn}{obspy}\PYG{n+nn}{.}\PYG{n+nn}{imaging}\PYG{n+nn}{.}\PYG{n+nn}{mopad\PYGZus{}wrapper} \PYG{k+kn}{import} \PYG{n}{beach}
\PYG{k+kn}{from} \PYG{n+nn}{MCMTpy} \PYG{k+kn}{import} \PYG{n}{MomentTensor} \PYG{k}{as} \PYG{n}{MTpy}

\PYG{c+c1}{\PYGZsh{} Helper function}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{}\PYGZpc{}\PYGZpc{} 1.read raw data}
\PYG{k}{def} \PYG{n+nf}{read\PYGZus{}data}\PYG{p}{(}\PYG{n}{allfiles\PYGZus{}path}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{allfiles} \PYG{o}{=} \PYG{n+nb}{sorted}\PYG{p}{(} \PYG{n}{glob}\PYG{o}{.}\PYG{n}{glob}\PYG{p}{(}\PYG{n}{allfiles\PYGZus{}path}\PYG{p}{)} \PYG{p}{)}
    \PYG{n}{data\PYGZus{}raw} \PYG{o}{=} \PYG{n}{Stream}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{allfiles}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{tr} \PYG{o}{=} \PYG{n}{obspy}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{n}{allfiles}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
            \PYG{n}{data\PYGZus{}raw} \PYG{o}{+}\PYG{o}{=} \PYG{n}{tr}
        \PYG{k}{except} \PYG{n+ne}{Exception}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{allfiles}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{: no such file or obspy read error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}\PYG{k}{continue}
    \PYG{n}{data} \PYG{o}{=} \PYG{n}{data\PYGZus{}raw}\PYG{o}{.}\PYG{n}{copy}\PYG{p}{(}\PYG{p}{)}
    
    \PYG{k}{return} \PYG{n}{data}

\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{}\PYGZpc{}\PYGZpc{} 2.taup ray trace}
\PYG{k}{def} \PYG{n+nf}{get\PYGZus{}taup\PYGZus{}tp\PYGZus{}ts}\PYG{p}{(}\PYG{n}{model}\PYG{p}{,}\PYG{n}{depth}\PYG{p}{,}\PYG{n}{distance}\PYG{p}{,}\PYG{n}{degree}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{if} \PYG{n}{degree}\PYG{o}{==}\PYG{k+kc}{False}\PYG{p}{:}
        \PYG{n}{distance} \PYG{o}{=} \PYG{n}{distance}\PYG{o}{/}\PYG{l+m+mf}{111.19}

    \PYG{n}{time\PYGZus{}p} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{get\PYGZus{}travel\PYGZus{}times}\PYG{p}{(}\PYG{n}{source\PYGZus{}depth\PYGZus{}in\PYGZus{}km}\PYG{o}{=}\PYG{n}{depth}\PYG{p}{,}
                                    \PYG{n}{distance\PYGZus{}in\PYGZus{}degree}\PYG{o}{=}\PYG{n}{distance}\PYG{p}{,}
                                    \PYG{n}{phase\PYGZus{}list}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{p}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{P}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}

    \PYG{n}{time\PYGZus{}s} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{get\PYGZus{}travel\PYGZus{}times}\PYG{p}{(}\PYG{n}{source\PYGZus{}depth\PYGZus{}in\PYGZus{}km}\PYG{o}{=}\PYG{n}{depth}\PYG{p}{,}
                                    \PYG{n}{distance\PYGZus{}in\PYGZus{}degree}\PYG{o}{=}\PYG{n}{distance}\PYG{p}{,}
                                    \PYG{n}{phase\PYGZus{}list}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{s}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{S}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}

    \PYG{n}{ray\PYGZus{}p} \PYG{o}{=} \PYG{n}{time\PYGZus{}p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{ray\PYGZus{}param}
    \PYG{n}{tp} \PYG{o}{=} \PYG{n}{time\PYGZus{}p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{time}
    \PYG{n}{angle\PYGZus{}p} \PYG{o}{=} \PYG{n}{time\PYGZus{}p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{incident\PYGZus{}angle}

    \PYG{n}{ray\PYGZus{}s} \PYG{o}{=} \PYG{n}{time\PYGZus{}s}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{ray\PYGZus{}param}
    \PYG{n}{ts} \PYG{o}{=} \PYG{n}{time\PYGZus{}s}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{time}
    \PYG{n}{angle\PYGZus{}s} \PYG{o}{=} \PYG{n}{time\PYGZus{}s}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{incident\PYGZus{}angle}

    \PYG{k}{return} \PYG{n}{ray\PYGZus{}p}\PYG{p}{,}\PYG{n}{tp}\PYG{p}{,}\PYG{n}{angle\PYGZus{}p}\PYG{p}{,}\PYG{n}{ray\PYGZus{}s}\PYG{p}{,}\PYG{n}{ts}\PYG{p}{,}\PYG{n}{angle\PYGZus{}s}


\PYG{c+c1}{\PYGZsh{}\PYGZpc{}\PYGZpc{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} 0. set path}
\PYG{n}{example\PYGZus{}path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/Users/yf/3.Project/8.MCMTpy/MCMTpy\PYGZhy{}master/data/example\PYGZus{}yunnan}\PYG{l+s+s1}{\PYGZsq{}}


\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} we expect no parameters need to be changed below}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{n}{FM\PYGZus{}path}\PYG{o}{=}\PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{YN.202105212148\PYGZus{}Inv/dc\PYGZus{}inv/Output\PYGZus{}YN.202105212148\PYGZus{}dc/rank\PYGZus{}0\PYGZus{}output/chain\PYGZus{}0\PYGZus{}FM\PYGZus{}accept\PYGZus{}all}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{allfiles\PYGZus{}path} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YN.202105212148\PYGZus{}Inv/YN.202105212148\PYGZus{}raw/*.SAC}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} 1. read FM}
\PYG{n}{N}\PYG{o}{=}\PYG{l+m+mi}{3} \PYG{c+c1}{\PYGZsh{} Three parameters are required to describe the focal mechanism}
\PYG{n}{FM\PYGZus{}all} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{loadtxt}\PYG{p}{(}\PYG{n}{FM\PYGZus{}path}\PYG{p}{)}
\PYG{n}{FM\PYGZus{}raw} \PYG{o}{=} \PYG{n}{FM\PYGZus{}all}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{c+c1}{\PYGZsh{} Define the number of solutions you want to plot}
\PYG{n}{strike\PYGZus{}np} \PYG{o}{=} \PYG{n}{FM\PYGZus{}raw}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{dip\PYGZus{}np} \PYG{o}{=} \PYG{n}{FM\PYGZus{}raw}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{n}{rake\PYGZus{}np} \PYG{o}{=} \PYG{n}{FM\PYGZus{}raw}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{FM} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{vstack}\PYG{p}{(}\PYG{p}{(}\PYG{n}{strike\PYGZus{}np}\PYG{p}{,} \PYG{n}{dip\PYGZus{}np}\PYG{p}{,}  \PYG{n}{rake\PYGZus{}np}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{T}
\PYG{n}{FM\PYGZus{}mean}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{shape}\PYG{o}{=}\PYG{p}{(}\PYG{n}{N}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{N}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{FM\PYGZus{}mean}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} 2.read raw data}
\PYG{n}{data} \PYG{o}{=} \PYG{n}{read\PYGZus{}data}\PYG{p}{(}\PYG{n}{allfiles\PYGZus{}path}\PYG{p}{)}
\PYG{n}{data}\PYG{o}{.}\PYG{n}{filter}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bandpass}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{freqmin}\PYG{o}{=}\PYG{l+m+mf}{0.005}\PYG{p}{,} \PYG{n}{freqmax}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{n}{corners}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{zerophase}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} 3.ray trace with taup}
\PYG{n}{model\PYGZus{}path} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{v\PYGZus{}model/v\PYGZus{}model.npz}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} 
\PYG{n}{model} \PYG{o}{=} \PYG{n}{TauPyModel}\PYG{p}{(}\PYG{n}{model}\PYG{o}{=}\PYG{n}{model\PYGZus{}path}\PYG{p}{)}    \PYG{c+c1}{\PYGZsh{} \PYGZdq{}iasp91\PYGZdq{}  \PYGZdq{}prem\PYGZdq{}}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{depth} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{evdp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
    \PYG{n}{distance} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dist}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
    \PYG{n}{ray\PYGZus{}p}\PYG{p}{,}\PYG{n}{tp}\PYG{p}{,}\PYG{n}{angle\PYGZus{}p}\PYG{p}{,}\PYG{n}{ray\PYGZus{}s}\PYG{p}{,}\PYG{n}{ts}\PYG{p}{,}\PYG{n}{angle\PYGZus{}s} \PYG{o}{=} \PYG{n}{get\PYGZus{}taup\PYGZus{}tp\PYGZus{}ts}\PYG{p}{(}\PYG{n}{model}\PYG{p}{,}\PYG{n}{depth}\PYG{p}{,}\PYG{n}{distance}\PYG{p}{,}\PYG{n}{degree}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}                                            
    \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{user1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{o}{=}\PYG{n}{angle\PYGZus{}p}
    \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{user2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{o}{=}\PYG{n}{angle\PYGZus{}s}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} 4.1 plot FM\PYGZus{}mean}
\PYG{n}{ax0} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{gca}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{Length\PYGZus{}Ball} \PYG{o}{=} \PYG{l+m+mi}{100}
\PYG{n}{beach1} \PYG{o}{=} \PYG{n}{beach}\PYG{p}{(}\PYG{n}{FM\PYGZus{}mean}\PYG{p}{,} \PYG{n}{xy}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{,} \PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{,}  \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{width}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYGZbs{}
               \PYG{n}{facecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{g}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{bgcolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{edgecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{mopad\PYGZus{}basis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NED}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{nofill}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1} \PYG{p}{)}
\PYG{n}{ax0}\PYG{o}{.}\PYG{n}{add\PYGZus{}collection}\PYG{p}{(}\PYG{n}{beach1}\PYG{p}{)} 
\PYG{n}{ax0}\PYG{o}{.}\PYG{n}{set\PYGZus{}aspect}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{equal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} 4.2 plot FM\PYGZus{}all}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{FM}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{beach1} \PYG{o}{=} \PYG{n}{beach}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xy}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{,} \PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{,}  \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{width}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYGZbs{}
                \PYG{n}{facecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{bgcolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{edgecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{orange}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{mopad\PYGZus{}basis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NED}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{nofill}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1} \PYG{p}{)}
    \PYG{n}{ax0}\PYG{o}{.}\PYG{n}{add\PYGZus{}collection}\PYG{p}{(}\PYG{n}{beach1}\PYG{p}{)} 
    \PYG{n}{ax0}\PYG{o}{.}\PYG{n}{set\PYGZus{}aspect}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{equal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} 4.3 plot backgroud line}
\PYG{n}{beach1} \PYG{o}{=} \PYG{n}{beach}\PYG{p}{(}\PYG{n}{FM\PYGZus{}mean}\PYG{p}{,} \PYG{n}{xy}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{,} \PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{,}  \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{width}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYGZbs{}
                \PYG{n}{facecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{bgcolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{edgecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{mopad\PYGZus{}basis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NED}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{nofill}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1} \PYG{p}{)}
\PYG{n}{ax0}\PYG{o}{.}\PYG{n}{add\PYGZus{}collection}\PYG{p}{(}\PYG{n}{beach1}\PYG{p}{)} 
\PYG{n}{ax0}\PYG{o}{.}\PYG{n}{set\PYGZus{}aspect}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{equal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} 5.plot station and waveform}
\PYG{n}{menthod}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{schmidt}\PYG{l+s+s1}{\PYGZsq{}}   \PYG{c+c1}{\PYGZsh{} \PYGZsq{}schmidt\PYGZsq{} \PYGZsq{}wulff\PYGZsq{}}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{AZM} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{az}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} 
    \PYG{n}{TKO} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{sac}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{user1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
    \PYG{n}{net\PYGZus{}sta\PYGZus{}name} \PYG{o}{=} \PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{network}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{station}    
    \PYG{n}{X}\PYG{p}{,} \PYG{n}{Y} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{p}{,} \PYG{n}{TKO}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}    
    \PYG{n}{tt}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{X}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{num}\PYG{o}{=}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{data}\PYG{p}{)}\PYG{p}{)} 
    \PYG{n}{ax0}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{rv}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{ms}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 
    \PYG{n}{ax0}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{tt}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{o}{*}\PYG{n}{data}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{data}\PYG{o}{/}\PYG{l+m+mi}{2000000} \PYG{o}{+} \PYG{n}{Y}\PYG{p}{,}  \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{lw}\PYG{o}{=}\PYG{l+m+mf}{0.2}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.6}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{ax0}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,}\PYG{n}{net\PYGZus{}sta\PYGZus{}name}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
          \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{bbox} \PYG{o}{=} \PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{facecolor} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{alpha} \PYG{o}{=} \PYG{l+m+mf}{0.0}\PYG{p}{)}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} 6. plot P/T/N axis}
\PYG{n}{MT} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{str\PYGZus{}dip\PYGZus{}rake2MT}\PYG{p}{(}\PYG{n}{strike}\PYG{o}{=}\PYG{n}{FM\PYGZus{}mean}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{n}{dip}\PYG{o}{=}\PYG{n}{FM\PYGZus{}mean}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{n}{rake}\PYG{o}{=}\PYG{n}{FM\PYGZus{}mean}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{T\PYGZus{}axis}\PYG{p}{,} \PYG{n}{P\PYGZus{}axis}\PYG{p}{,} \PYG{n}{N\PYGZus{}axis} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MT2TPN}\PYG{p}{(}\PYG{n}{MT}\PYG{p}{)}
\PYG{n}{T} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{T\PYGZus{}axis}\PYG{p}{)}
\PYG{n}{P} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{P\PYGZus{}axis}\PYG{p}{)}
\PYG{n}{N} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{N\PYGZus{}axis}\PYG{p}{)}

\PYG{n}{Tx}\PYG{p}{,} \PYG{n}{Ty} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{T}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{T}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
\PYG{n}{ax0}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{Tx}\PYG{p}{,}\PYG{n}{Ty}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
          \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

\PYG{n}{Px}\PYG{p}{,} \PYG{n}{Py} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{P}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{P}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
\PYG{n}{ax0}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{Px}\PYG{p}{,}\PYG{n}{Py}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{P}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
          \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

\PYG{n}{Nx}\PYG{p}{,} \PYG{n}{Ny} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{N}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{N}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
\PYG{n}{ax0}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{Nx}\PYG{p}{,}\PYG{n}{Ny}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
          \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 


\PYG{c+c1}{\PYGZsh{}\PYGZsh{} 7. save figure}
\PYG{n}{ax0}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}
\PYG{n}{ax0}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}
\PYG{n}{ax0}\PYG{o}{.}\PYG{n}{set\PYGZus{}axis\PYGZus{}off}\PYG{p}{(}\PYG{p}{)} 
\PYG{n}{figurename}\PYG{o}{=}\PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{./S2\PYGZus{}figure/beachball.pdf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{figurename}\PYG{p}{,}\PYG{n}{dpi}\PYG{o}{=}\PYG{l+m+mi}{800}\PYG{p}{,} \PYG{n+nb}{format}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{pdf}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{beachball1}.png}\hspace*{\fill}}


\subsection{Moment Tensor Decompose}
\label{\detokenize{tutorials/S8_Decompose_MT:moment-tensor-decompose}}\label{\detokenize{tutorials/S8_Decompose_MT::doc}}\begin{itemize}
\item {} 
The \sphinxstylestrong{example\_path} need to de changed to your path, and run this notebook.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}*\PYGZhy{} coding: utf\PYGZhy{}8 \PYGZhy{}*\PYGZhy{}}

\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{glob}
\PYG{k+kn}{import} \PYG{n+nn}{obspy}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{from} \PYG{n+nn}{obspy} \PYG{k+kn}{import} \PYG{n}{Stream}
\PYG{k+kn}{from} \PYG{n+nn}{obspy}\PYG{n+nn}{.}\PYG{n+nn}{taup} \PYG{k+kn}{import} \PYG{n}{TauPyModel}
\PYG{k+kn}{from} \PYG{n+nn}{obspy}\PYG{n+nn}{.}\PYG{n+nn}{imaging}\PYG{n+nn}{.}\PYG{n+nn}{mopad\PYGZus{}wrapper} \PYG{k+kn}{import} \PYG{n}{beach}
\PYG{k+kn}{from} \PYG{n+nn}{MCMTpy} \PYG{k+kn}{import} \PYG{n}{MomentTensor} \PYG{k}{as} \PYG{n}{MTpy}

\PYG{c+c1}{\PYGZsh{} Helper function}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{}\PYGZpc{}\PYGZpc{} 1.plot decompose mt}
\PYG{k}{def} \PYG{n+nf}{plot\PYGZus{}decompose}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{,}\PYG{n}{FM\PYGZus{}DC}\PYG{p}{,}\PYG{n}{FM\PYGZus{}CLVD}\PYG{p}{,}\PYG{n}{FM\PYGZus{}iso}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{MT} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MTensor}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{)}
    \PYG{n}{Dec} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{Decompose}\PYG{p}{(}\PYG{n}{MT}\PYG{p}{)}
    \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{decomposition\PYGZus{}iso\PYGZus{}DC\PYGZus{}CLVD}\PYG{p}{(}\PYG{p}{)}
    
    \PYG{n}{fig2}\PYG{p}{,} \PYG{n}{ax2} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{1} \PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}  \PYG{n}{dpi}\PYG{o}{=}\PYG{l+m+mi}{800}\PYG{p}{)}
    \PYG{n}{Length\PYGZus{}Ball} \PYG{o}{=} \PYG{l+m+mi}{100}

    \PYG{c+c1}{\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{} MT}
    \PYG{n}{beach1} \PYG{o}{=} \PYG{n}{beach}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{,} \PYG{n}{xy}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{,} \PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{,}  \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{width}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYGZbs{}
                   \PYG{n}{facecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{g}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{bgcolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{edgecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{mopad\PYGZus{}basis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NED}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{nofill}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1} \PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{add\PYGZus{}collection}\PYG{p}{(}\PYG{n}{beach1}\PYG{p}{)} 
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}aspect}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{equal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{n}{menthod}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{schmidt}\PYG{l+s+s1}{\PYGZsq{}}   \PYG{c+c1}{\PYGZsh{} \PYGZsq{}schmidt\PYGZsq{}  \PYGZsh{} \PYGZsq{}wulff\PYGZsq{}}
    \PYG{n}{T\PYGZus{}axis}\PYG{p}{,} \PYG{n}{P\PYGZus{}axis}\PYG{p}{,} \PYG{n}{N\PYGZus{}axis} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MT2TPN}\PYG{p}{(}\PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MTensor}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{T} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{T\PYGZus{}axis}\PYG{p}{)}
    \PYG{n}{P} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{P\PYGZus{}axis}\PYG{p}{)}
    \PYG{n}{N} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{N\PYGZus{}axis}\PYG{p}{)}

    \PYG{n}{Tx}\PYG{p}{,} \PYG{n}{Ty} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{T}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{T}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{Tx}\PYG{p}{,}\PYG{n}{Ty}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

    \PYG{n}{Px}\PYG{p}{,} \PYG{n}{Py} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{P}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{P}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{Px}\PYG{p}{,}\PYG{n}{Py}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{P}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

    \PYG{n}{Nx}\PYG{p}{,} \PYG{n}{Ny} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{N}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{N}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{Nx}\PYG{p}{,}\PYG{n}{Ny}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

    \PYG{c+c1}{\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{} DC}
    \PYG{n}{beach2} \PYG{o}{=} \PYG{n}{beach}\PYG{p}{(}\PYG{n}{FM\PYGZus{}DC}\PYG{p}{,} \PYG{n}{xy}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{200}\PYG{p}{,} \PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{,}  \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{width}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYGZbs{}
                   \PYG{n}{facecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{g}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{bgcolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{edgecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{mopad\PYGZus{}basis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NED}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{nofill}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1} \PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{add\PYGZus{}collection}\PYG{p}{(}\PYG{n}{beach2}\PYG{p}{)} 
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}aspect}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{equal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{n}{menthod}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{schmidt}\PYG{l+s+s1}{\PYGZsq{}}   \PYG{c+c1}{\PYGZsh{} \PYGZsq{}schmidt\PYGZsq{}  \PYGZsh{} \PYGZsq{}wulff\PYGZsq{}}
    \PYG{n}{T\PYGZus{}axis}\PYG{p}{,} \PYG{n}{P\PYGZus{}axis}\PYG{p}{,} \PYG{n}{N\PYGZus{}axis} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MT2TPN}\PYG{p}{(}\PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MTensor}\PYG{p}{(}\PYG{n}{FM\PYGZus{}DC}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{T} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{T\PYGZus{}axis}\PYG{p}{)}
    \PYG{n}{P} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{P\PYGZus{}axis}\PYG{p}{)}
    \PYG{n}{N} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{N\PYGZus{}axis}\PYG{p}{)}

    \PYG{n}{Tx}\PYG{p}{,} \PYG{n}{Ty} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{T}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{T}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{150}\PYG{o}{*}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{Tx}\PYG{p}{,}\PYG{n}{Ty}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

    \PYG{n}{Px}\PYG{p}{,} \PYG{n}{Py} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{P}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{P}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{150}\PYG{o}{*}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{Px}\PYG{p}{,}\PYG{n}{Py}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{P}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

    \PYG{n}{Nx}\PYG{p}{,} \PYG{n}{Ny} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{N}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{N}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{150}\PYG{o}{*}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{Nx}\PYG{p}{,}\PYG{n}{Ny}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

    \PYG{c+c1}{\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{} CLVD}
    \PYG{n}{beach3} \PYG{o}{=} \PYG{n}{beach}\PYG{p}{(}\PYG{n}{FM\PYGZus{}CLVD}\PYG{p}{,} \PYG{n}{xy}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{350}\PYG{p}{,} \PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{,}  \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{width}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYGZbs{}
                   \PYG{n}{facecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{g}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{bgcolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{edgecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{mopad\PYGZus{}basis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NED}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{nofill}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1} \PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{add\PYGZus{}collection}\PYG{p}{(}\PYG{n}{beach3}\PYG{p}{)} 
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}aspect}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{equal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{n}{menthod}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{schmidt}\PYG{l+s+s1}{\PYGZsq{}}   \PYG{c+c1}{\PYGZsh{} \PYGZsq{}schmidt\PYGZsq{}  \PYGZsh{} \PYGZsq{}wulff\PYGZsq{}}
    \PYG{n}{T\PYGZus{}axis}\PYG{p}{,} \PYG{n}{P\PYGZus{}axis}\PYG{p}{,} \PYG{n}{N\PYGZus{}axis} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MT2TPN}\PYG{p}{(}\PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MTensor}\PYG{p}{(}\PYG{n}{FM\PYGZus{}CLVD}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{T} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{T\PYGZus{}axis}\PYG{p}{)}
    \PYG{n}{P} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{P\PYGZus{}axis}\PYG{p}{)}
    \PYG{n}{N} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{N\PYGZus{}axis}\PYG{p}{)}

    \PYG{n}{Tx}\PYG{p}{,} \PYG{n}{Ty} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{T}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{T}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{150}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{Tx}\PYG{p}{,}\PYG{n}{Ty}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

    \PYG{n}{Px}\PYG{p}{,} \PYG{n}{Py} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{P}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{P}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{150}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{Px}\PYG{p}{,}\PYG{n}{Py}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{P}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

    \PYG{n}{Nx}\PYG{p}{,} \PYG{n}{Ny} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{N}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{N}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{150}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{Nx}\PYG{p}{,}\PYG{n}{Ny}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

    \PYG{c+c1}{\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{} iso}
    \PYG{n}{beach4} \PYG{o}{=} \PYG{n}{beach}\PYG{p}{(}\PYG{n}{FM\PYGZus{}iso}\PYG{p}{,} \PYG{n}{xy}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{500}\PYG{p}{,} \PYG{l+m+mi}{50}\PYG{p}{)}\PYG{p}{,}  \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{width}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYGZbs{}
                   \PYG{n}{facecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{g}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{bgcolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{edgecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{mopad\PYGZus{}basis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NED}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{nofill}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1} \PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{add\PYGZus{}collection}\PYG{p}{(}\PYG{n}{beach4}\PYG{p}{)} 
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}aspect}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{equal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{n}{menthod}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{schmidt}\PYG{l+s+s1}{\PYGZsq{}}   \PYG{c+c1}{\PYGZsh{} \PYGZsq{}schmidt\PYGZsq{}  \PYGZsh{} \PYGZsq{}wulff\PYGZsq{}}
    \PYG{n}{T\PYGZus{}axis}\PYG{p}{,} \PYG{n}{P\PYGZus{}axis}\PYG{p}{,} \PYG{n}{N\PYGZus{}axis} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MT2TPN}\PYG{p}{(}\PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MTensor}\PYG{p}{(}\PYG{n}{FM\PYGZus{}iso}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{T} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{T\PYGZus{}axis}\PYG{p}{)}
    \PYG{n}{P} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{P\PYGZus{}axis}\PYG{p}{)}
    \PYG{n}{N} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{vector2str\PYGZus{}dip}\PYG{p}{(}\PYG{n}{N\PYGZus{}axis}\PYG{p}{)}

    \PYG{n}{Tx}\PYG{p}{,} \PYG{n}{Ty} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{T}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{T}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{150}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{Tx}\PYG{p}{,}\PYG{n}{Ty}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

    \PYG{n}{Px}\PYG{p}{,} \PYG{n}{Py} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{P}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{P}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{150}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{Px}\PYG{p}{,}\PYG{n}{Py}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{P}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} 

    \PYG{n}{Nx}\PYG{p}{,} \PYG{n}{Ny} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{project\PYGZus{}beachball}\PYG{p}{(}\PYG{n}{AZM}\PYG{o}{=}\PYG{n}{N}\PYG{o}{.}\PYG{n}{strike}\PYG{p}{,} \PYG{n}{TKO}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{o}{\PYGZhy{}}\PYG{n}{N}\PYG{o}{.}\PYG{n}{dip}\PYG{p}{)}\PYG{p}{,} \PYG{n}{R}\PYG{o}{=}\PYG{n}{Length\PYGZus{}Ball}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{menthod}\PYG{o}{=}\PYG{n}{menthod}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{150}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{Nx}\PYG{p}{,}\PYG{n}{Ny}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{} plot \PYGZsq{}+\PYGZsq{} and \PYGZsq{}=\PYGZsq{}}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{125}\PYG{p}{,}\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{275}\PYG{p}{,}\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{425}\PYG{p}{,}\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{} plot percentage}
    \PYG{n}{MT\PYGZus{}text} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MT}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{n}{MT\PYGZus{}text}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{8}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
    
    \PYG{n}{iso\PYGZus{}text} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ISO: }\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}iso\PYGZus{}percentage}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{500}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{n}{iso\PYGZus{}text}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{8}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
    
    \PYG{n}{DC\PYGZus{}text} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{DC: }\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}DC\PYGZus{}percentage}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{200}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{n}{DC\PYGZus{}text}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{8}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
    
    \PYG{n}{CLVD\PYGZus{}text} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CLVD: }\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}CLVD\PYGZus{}percentage}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{350}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{n}{CLVD\PYGZus{}text}\PYG{p}{,}\PYG{n}{horizontalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{verticalalignment}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYGZbs{}
              \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{8}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{zorder}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{} set figure}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Decompose}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{550}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylim}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{30}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}
    \PYG{n}{ax2}\PYG{o}{.}\PYG{n}{set\PYGZus{}axis\PYGZus{}off}\PYG{p}{(}\PYG{p}{)} 

    \PYG{k}{return} \PYG{n}{fig2}

\PYG{c+c1}{\PYGZsh{}\PYGZpc{}\PYGZpc{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} 1.set FM}
\PYG{c+c1}{\PYGZsh{} [Mxx\PYGZus{}np,  Myy\PYGZus{}np,  Mzz\PYGZus{}np,  Mxy\PYGZus{}np,  Mxz\PYGZus{}np,  Myz\PYGZus{}np] or [strike,dip,rake]}
\PYG{n}{FM}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{150}\PYG{p}{,}\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{]}


\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} we expect no parameters need to be changed below}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{n}{MT} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MTensor}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{)}
\PYG{n}{Dec} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{Decompose}\PYG{p}{(}\PYG{n}{MT}\PYG{p}{)}
\PYG{n}{Dec}\PYG{o}{.}\PYG{n}{decomposition\PYGZus{}iso\PYGZus{}DC\PYGZus{}CLVD}\PYG{p}{(}\PYG{p}{)}   \PYG{c+c1}{\PYGZsh{} Dec.help()}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{Dec}\PYG{o}{.}\PYG{n}{help}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{*********************************}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{Dec}\PYG{o}{.}\PYG{n}{print\PYGZus{}self}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{Mxx} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}iso}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{Mxy} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}iso}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{n}{Mxz} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}iso}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{Myy} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}iso}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{n}{Myz} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}iso}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{Mzz} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}iso}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{FM\PYGZus{}iso} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{(}\PYG{n}{Mxx}\PYG{p}{,}  \PYG{n}{Myy}\PYG{p}{,}  \PYG{n}{Mzz}\PYG{p}{,}  \PYG{n}{Mxy}\PYG{p}{,}  \PYG{n}{Mxz}\PYG{p}{,}  \PYG{n}{Myz}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{Mxx} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}DC}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{Mxy} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}DC}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{n}{Mxz} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}DC}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{Myy} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}DC}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{n}{Myz} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}DC}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{Mzz} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}DC}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{FM\PYGZus{}DC} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{(}\PYG{n}{Mxx}\PYG{p}{,}  \PYG{n}{Myy}\PYG{p}{,}  \PYG{n}{Mzz}\PYG{p}{,}  \PYG{n}{Mxy}\PYG{p}{,}  \PYG{n}{Mxz}\PYG{p}{,}  \PYG{n}{Myz}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{Mxx} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}CLVD}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{Mxy} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}CLVD}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{n}{Mxz} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}CLVD}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{Myy} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}CLVD}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{n}{Myz} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}CLVD}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{Mzz} \PYG{o}{=} \PYG{n}{Dec}\PYG{o}{.}\PYG{n}{M\PYGZus{}CLVD}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{FM\PYGZus{}CLVD} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{(}\PYG{n}{Mxx}\PYG{p}{,}  \PYG{n}{Myy}\PYG{p}{,}  \PYG{n}{Mzz}\PYG{p}{,}  \PYG{n}{Mxy}\PYG{p}{,}  \PYG{n}{Mxz}\PYG{p}{,}  \PYG{n}{Myz}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plot\PYGZus{}decompose}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{,} \PYG{n}{FM\PYGZus{}DC}\PYG{p}{,} \PYG{n}{FM\PYGZus{}CLVD}\PYG{p}{,} \PYG{n}{FM\PYGZus{}iso}\PYG{p}{)}
\PYG{n}{figurename}\PYG{o}{=}\PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{./S2\PYGZus{}figure/Decompose.pdf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{figurename}\PYG{p}{,}\PYG{n}{dpi}\PYG{o}{=}\PYG{l+m+mi}{800}\PYG{p}{,} \PYG{n+nb}{format}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{pdf}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
\sphinxstylestrong{Decompose reuslt}.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
Incluing function:
self.M
self.M\PYGZus{}iso
self.M\PYGZus{}devi
self.M\PYGZus{}DC
self.M\PYGZus{}CLVD
self.M0
self.Mw
self.M\PYGZus{}iso\PYGZus{}percentage
self.M\PYGZus{}DC\PYGZus{}percentage
self.M\PYGZus{}CLVD\PYGZus{}percentage
self.eigen\PYGZus{}val
self.eigen\PYGZus{}vec
self.F
None


*********************************


self.M: [[\PYGZhy{}0.3576622  \PYGZhy{}0.48646688 \PYGZhy{}0.01115976]
 [\PYGZhy{}0.48646688 \PYGZhy{}0.61218411  0.20390851]
 [\PYGZhy{}0.01115976  0.20390851  0.96984631]] 

self.M\PYGZus{}iso: [[ \PYGZhy{}3.70074342e\PYGZhy{}17   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00  \PYGZhy{}3.70074342e\PYGZhy{}17   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00  \PYGZhy{}3.70074342e\PYGZhy{}17]] 

self.M\PYGZus{}devi: [[\PYGZhy{}0.3576622  \PYGZhy{}0.48646688 \PYGZhy{}0.01115976]
 [\PYGZhy{}0.48646688 \PYGZhy{}0.61218411  0.20390851]
 [\PYGZhy{}0.01115976  0.20390851  0.96984631]] 

self.M\PYGZus{}DC: [[\PYGZhy{}0.3576622  \PYGZhy{}0.48646688 \PYGZhy{}0.01115976]
 [\PYGZhy{}0.48646688 \PYGZhy{}0.61218411  0.20390851]
 [\PYGZhy{}0.01115976  0.20390851  0.96984631]] 

self.M\PYGZus{}CLVD: [[  3.33066907e\PYGZhy{}16   1.66533454e\PYGZhy{}16  \PYGZhy{}2.77555756e\PYGZhy{}17]
 [  1.66533454e\PYGZhy{}16  \PYGZhy{}2.22044605e\PYGZhy{}16   5.55111512e\PYGZhy{}17]
 [ \PYGZhy{}2.77555756e\PYGZhy{}17   5.55111512e\PYGZhy{}17   0.00000000e+00]] 

self.M0: 1.0 

self.Mw: \PYGZhy{}6.06666666667 

self.M\PYGZus{}iso\PYGZus{}percentage: 0 

self.M\PYGZus{}DC\PYGZus{}percentage: 100 

self.M\PYGZus{}CLVD\PYGZus{}percentage: 0 

self.eigen\PYGZus{}val: [ \PYGZhy{}1.00000000e+00  \PYGZhy{}5.46437895e\PYGZhy{}17   1.00000000e+00] 

self.eigen\PYGZus{}vec: [[\PYGZhy{}0.60098212 \PYGZhy{}0.79705908 \PYGZhy{}0.0593069 ]
 [\PYGZhy{}0.79535596  0.58906868  0.14285304]
 [ 0.07892648 \PYGZhy{}0.13302222  0.98796543]] 

self.F: \PYGZhy{}1.76363553391e\PYGZhy{}17 
\end{sphinxVerbatim}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{Decompose1}.png}\hspace*{\fill}}


\subsection{Huston Plot}
\label{\detokenize{tutorials/S9_Plot_Hudson:huston-plot}}\label{\detokenize{tutorials/S9_Plot_Hudson::doc}}\begin{itemize}
\item {} 
The \sphinxstylestrong{example\_path} need to de changed to your path, and run this notebook.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}*\PYGZhy{} coding: utf\PYGZhy{}8 \PYGZhy{}*\PYGZhy{}}
\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{from} \PYG{n+nn}{matplotlib} \PYG{k+kn}{import} \PYG{n}{cm}
\PYG{k+kn}{from} \PYG{n+nn}{MCMTpy} \PYG{k+kn}{import} \PYG{n}{MomentTensor} \PYG{k}{as} \PYG{n}{MTpy}

\PYG{c+c1}{\PYGZsh{} Helper function}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{}\PYGZpc{}\PYGZpc{} 4. plot\PYGZus{}Hudson\PYGZus{}points}
\PYG{k}{def} \PYG{n+nf}{plot\PYGZus{}Hudson\PYGZus{}points}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{fig1}\PYG{p}{,} \PYG{n}{ax1} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{1} \PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}  \PYG{n}{dpi}\PYG{o}{=}\PYG{l+m+mi}{800}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{rc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{font}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{family}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Times New Roman}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{Hudson\PYGZus{}plot}\PYG{p}{(}\PYG{n}{ax}\PYG{o}{=}\PYG{n}{ax1}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:} 
        \PYG{n}{MT} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{MTensor}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{M}\PYG{o}{=}\PYG{n}{MT}\PYG{o}{.}\PYG{n}{mt}

        \PYG{n}{k}\PYG{p}{,}\PYG{n}{T} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{M2kT\PYGZus{}space}\PYG{p}{(}\PYG{n}{M}\PYG{p}{)}
        \PYG{n}{U}\PYG{p}{,}\PYG{n}{V} \PYG{o}{=} \PYG{n}{MTpy}\PYG{o}{.}\PYG{n}{kT2UV\PYGZus{}space}\PYG{p}{(}\PYG{n}{k}\PYG{p}{,}\PYG{n}{T}\PYG{p}{)}
    
        \PYG{n}{map\PYGZus{}vir} \PYG{o}{=} \PYG{n}{cm}\PYG{o}{.}\PYG{n}{get\PYGZus{}cmap}\PYG{p}{(}\PYG{n}{name}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YlGn}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
        \PYG{n}{colors} \PYG{o}{=} \PYG{n}{map\PYGZus{}vir}\PYG{p}{(}\PYG{n}{i}\PYG{o}{/}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{)}\PYG{p}{)}
    
        \PYG{n}{ax1}\PYG{o}{.}\PYG{n}{scatter}\PYG{p}{(}\PYG{n}{U}\PYG{p}{,}\PYG{n}{V}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{n}{colors}\PYG{p}{,}\PYG{n}{marker}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{o}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{s}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}


    \PYG{n}{position}\PYG{o}{=}\PYG{n}{fig1}\PYG{o}{.}\PYG{n}{add\PYGZus{}axes}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.85}\PYG{p}{,} \PYG{l+m+mf}{0.15}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{font\PYGZus{}colorbar} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{family}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Times New Roman}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{color}\PYG{l+s+s1}{\PYGZsq{}}  \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{weight}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size}\PYG{l+s+s1}{\PYGZsq{}}   \PYG{p}{:} \PYG{l+m+mi}{6}\PYG{p}{,}
            \PYG{p}{\PYGZcb{}}
    \PYG{n}{sm} \PYG{o}{=} \PYG{n}{cm}\PYG{o}{.}\PYG{n}{ScalarMappable}\PYG{p}{(}\PYG{n}{cmap}\PYG{o}{=}\PYG{n}{map\PYGZus{}vir}\PYG{p}{)}               
    \PYG{n}{sm}\PYG{o}{.}\PYG{n}{set\PYGZus{}array}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}    
    \PYG{n}{cb}\PYG{o}{=}\PYG{n}{plt}\PYG{o}{.}\PYG{n}{colorbar}\PYG{p}{(}\PYG{n}{sm}\PYG{p}{,}\PYG{n}{cax}\PYG{o}{=}\PYG{n}{position}\PYG{p}{,}\PYG{n}{orientation}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{vertical}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 
    \PYG{n}{cb}\PYG{o}{.}\PYG{n}{set\PYGZus{}label}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sample}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{fontdict}\PYG{o}{=}\PYG{n}{font\PYGZus{}colorbar}\PYG{p}{)}

    \PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mf}{0.3}\PYG{p}{)}
    \PYG{n}{ax1}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylim}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{o}{+}\PYG{l+m+mf}{0.1}\PYG{p}{)}
    
    \PYG{k}{return} \PYG{n}{fig1}


\PYG{c+c1}{\PYGZsh{}\PYGZpc{}\PYGZpc{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} 0. set path}
\PYG{n}{example\PYGZus{}path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/Users/yf/3.Project/8.MCMTpy/MCMTpy\PYGZhy{}master/data/example\PYGZus{}yunnan}\PYG{l+s+s1}{\PYGZsq{}}


\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} we expect no parameters need to be changed below}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsh{}}
\PYG{n}{FM\PYGZus{}path}\PYG{o}{=}\PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{YN.202105212148\PYGZus{}Inv/mt\PYGZus{}inv/Output\PYGZus{}YN.202105212148\PYGZus{}mt/rank\PYGZus{}0\PYGZus{}output/chain\PYGZus{}0\PYGZus{}FM\PYGZus{}accept\PYGZus{}all}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{allfiles\PYGZus{}path} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{example\PYGZus{}path}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YN.202105212148\PYGZus{}Inv/YN.202105212148\PYGZus{}raw/*.SAC}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} 1. read FM}
\PYG{n}{N}\PYG{o}{=}\PYG{l+m+mi}{6}
\PYG{n}{FM\PYGZus{}all} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{loadtxt}\PYG{p}{(}\PYG{n}{FM\PYGZus{}path}\PYG{p}{)}
\PYG{n}{FM\PYGZus{}raw} \PYG{o}{=} \PYG{n}{FM\PYGZus{}all}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{n}{Mxx\PYGZus{}np} \PYG{o}{=} \PYG{n}{FM\PYGZus{}raw}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{Mxy\PYGZus{}np} \PYG{o}{=} \PYG{n}{FM\PYGZus{}raw}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{n}{Mxz\PYGZus{}np} \PYG{o}{=} \PYG{n}{FM\PYGZus{}raw}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{Myy\PYGZus{}np} \PYG{o}{=} \PYG{n}{FM\PYGZus{}raw}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{]}
\PYG{n}{Myz\PYGZus{}np} \PYG{o}{=} \PYG{n}{FM\PYGZus{}raw}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}
\PYG{n}{Mzz\PYGZus{}np} \PYG{o}{=} \PYG{n}{FM\PYGZus{}raw}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{]}
\PYG{n}{FM} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{vstack}\PYG{p}{(}\PYG{p}{(}\PYG{n}{Mxx\PYGZus{}np}\PYG{p}{,}  \PYG{n}{Myy\PYGZus{}np}\PYG{p}{,}  \PYG{n}{Mzz\PYGZus{}np}\PYG{p}{,}  \PYG{n}{Mxy\PYGZus{}np}\PYG{p}{,}  \PYG{n}{Mxz\PYGZus{}np}\PYG{p}{,}  \PYG{n}{Myz\PYGZus{}np}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{T}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} 2. plot Hudson}
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plot\PYGZus{}Hudson\PYGZus{}points}\PYG{p}{(}\PYG{n}{FM}\PYG{p}{)}
\PYG{n}{figurename}\PYG{o}{=}\PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{./S2\PYGZus{}figure/Hudson.pdf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{figurename}\PYG{p}{,}\PYG{n}{dpi}\PYG{o}{=}\PYG{l+m+mi}{800}\PYG{p}{,} \PYG{n+nb}{format}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{pdf}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=1.000\linewidth]{{Hudson_plot}.png}\hspace*{\fill}}


\section{References}
\label{\detokenize{references:references}}\label{\detokenize{references::doc}}

\subsection{ASDF}
\label{\detokenize{references:asdf}}
The \sphinxcode{\sphinxupquote{pyasdf}} Github repository \sphinxurl{https://github.com/SeismicData/pyasdf}.
\begin{itemize}
\item {} 
Krischer, L., Smith, J., Lei, W., Lefebvre, M., Ruan, Y., de Andrade, E.S., Podhorszki, N., Bozdağ, E.
and Tromp, J., 2016. An adaptable seismic data format. Geophysical Supplements to the Monthly Notices
of the Royal Astronomical Society, 207(2), 1003\sphinxhyphen{}1011.

\end{itemize}


\subsection{pyfk}
\label{\detokenize{references:pyfk}}
The \sphinxcode{\sphinxupquote{pyfk}} Github repository \sphinxurl{https://github.com/ziyixi/pyfk}.


\subsection{NoisePy}
\label{\detokenize{references:noisepy}}
The \sphinxcode{\sphinxupquote{NoisePy}} Github repository \sphinxurl{https://noise-python.readthedocs.io/en/latest/examples.html}.
\begin{itemize}
\item {} 
Jiang, C., Yuan, C., and Denolle, M. NoisePy: a new high\sphinxhyphen{}performance python tool for seismic
ambient noise seismology.

\end{itemize}


\subsection{MoPaD}
\label{\detokenize{references:mopad}}
The \sphinxcode{\sphinxupquote{MoPaD}} website \sphinxurl{http://www.larskrieger.de/mopad/}
\begin{itemize}
\item {} 
Lars Krieger and Sebastian Heimann. MoPad —Moment Tensor Plotting and Decomposition: A Tool for
Graphical and Numerical Analysis of Seismic Moment Tensors.

\end{itemize}


\subsection{BEAT}
\label{\detokenize{references:beat}}
The \sphinxcode{\sphinxupquote{BEAT}} website \sphinxurl{https://hvasbath.github.io/beat/index.html}
\begin{itemize}
\item {} 
Vasyura\sphinxhyphen{}Bathke, H.,J. Dettmer, A. Steinberg, S. Heimann, M. P. Isken, O. Zielke, P. M. Mai, H. Sudhaus,
and S. Jónsson (2020). The Bayesian Earthquake Analysis Tool, Seismol. Res. Lett. 91, 1003–1018,
doi: 10.1785/0220190075.

\end{itemize}


\subsection{Other references adding…}
\label{\detokenize{references:other-references-adding}}
Working on that…


\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}



\renewcommand{\indexname}{Index}
\printindex
\end{document}